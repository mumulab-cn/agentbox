<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QKVçŸ©é˜µç”Ÿæˆè¯¦è§£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%);
            color: #333;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #3f51b5;
            margin-bottom: 15px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1em;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 1.8em;
            color: #3f51b5;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #9fa8da;
        }
        
        .content-text {
            color: #555;
            font-size: 1.05em;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        
        .highlight {
            color: #3f51b5;
            font-weight: bold;
            background: #e8eaf6;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        /* QKVè½¬æ¢å¯è§†åŒ– */
        .qkv-transform {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 40px 0;
            padding: 30px;
            background: linear-gradient(135deg, #e8eaf6, #c5cae9);
            border-radius: 15px;
            flex-wrap: wrap;
            gap: 30px;
        }
        
        .transform-box {
            text-align: center;
        }
        
        .box-label {
            color: #3f51b5;
            font-weight: bold;
            font-size: 1.3em;
            margin-bottom: 15px;
        }
        
        .matrix-visual {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-width: 150px;
        }
        
        .matrix-grid {
            display: grid;
            grid-template-columns: repeat(4, 40px);
            gap: 5px;
        }
        
        .matrix-cell {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #5c6bc0, #3f51b5);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8em;
            font-weight: bold;
            animation: cellPop 0.5s ease-out;
        }
        
        @keyframes cellPop {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .matrix-cell.q { background: linear-gradient(135deg, #42a5f5, #1e88e5); }
        .matrix-cell.k { background: linear-gradient(135deg, #66bb6a, #43a047); }
        .matrix-cell.v { background: linear-gradient(135deg, #ffa726, #fb8c00); }
        
        .operator {
            font-size: 3em;
            color: #3f51b5;
            font-weight: bold;
        }
        
        .matrix-desc {
            margin-top: 12px;
            font-size: 0.9em;
            color: #666;
        }
        
        /* æƒé‡çŸ©é˜µå±•ç¤º */
        .weight-matrices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .weight-card {
            background: linear-gradient(135deg, #e8eaf6, #c5cae9);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .weight-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(63, 81, 181, 0.3);
        }
        
        .weight-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .weight-title.q { color: #1e88e5; }
        .weight-title.k { color: #43a047; }
        .weight-title.v { color: #fb8c00; }
        
        .weight-info {
            background: white;
            padding: 15px;
            border-radius: 8px;
            color: #555;
            line-height: 1.8;
        }
        
        /* å…¬å¼æ¡† */
        .formula-box {
            background: linear-gradient(135deg, #e8eaf6, #c5cae9);
            border-left: 5px solid #3f51b5;
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
        }
        
        .formula {
            font-size: 1.3em;
            color: #3f51b5;
            text-align: center;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            font-weight: bold;
        }
        
        /* è®¡ç®—ç¤ºä¾‹ */
        .calculation-example {
            background: #fff3e0;
            border: 3px solid #ffb74d;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .calc-title {
            color: #f57c00;
            font-size: 1.4em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .calc-step {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #ffb74d;
        }
        
        .step-header {
            color: #f57c00;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }
        
        .step-content {
            color: #555;
            line-height: 1.8;
        }
        
        .matrix-calc {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .calc-matrix {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }
        
        .calc-matrix.input { border-color: #5c6bc0; }
        .calc-matrix.q { border-color: #1e88e5; }
        .calc-matrix.k { border-color: #43a047; }
        .calc-matrix.v { border-color: #fb8c00; }
        
        /* å¯¹æ¯”è¡¨æ ¼ */
        .comparison-table {
            width: 100%;
            margin: 30px 0;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #5c6bc0, #3f51b5);
            color: white;
            padding: 15px;
            font-weight: bold;
            text-align: left;
        }
        
        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            color: #555;
        }
        
        .comparison-table tr:hover {
            background: #e8eaf6;
        }
        
        /* æç¤ºæ¡† */
        .tip-box {
            background: #e8f5e9;
            border-left: 5px solid #66bb6a;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
        }
        
        .tip-title {
            color: #2e7d32;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        
        .tip-content {
            color: #555;
            line-height: 1.8;
        }
        
        /* ä»£ç å— */
        .code-block {
            background: #263238;
            color: #aed581;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 25px 0;
            overflow-x: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .qkv-transform {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”‘ Queryã€Keyã€ValueçŸ©é˜µç”Ÿæˆ</h1>
        <p class="subtitle">è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„æ ¸å¿ƒï¼šå°†è¾“å…¥è½¬æ¢ä¸ºQã€Kã€Vä¸‰ä¸ªçŸ©é˜µ</p>
        
        <!-- 1. åŸºæœ¬æ¦‚å¿µ -->
        <div class="section">
            <h2 class="section-title">ä¸€ã€ä»€ä¹ˆæ˜¯Qã€Kã€VçŸ©é˜µ</h2>
            <p class="content-text">
                åœ¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸­ï¼Œæ¯ä¸ªè¾“å…¥å‘é‡éœ€è¦è½¬æ¢æˆä¸‰ä¸ªä¸åŒçš„è¡¨ç¤ºï¼š
            </p>
            
            <ul style="color: #555; margin-left: 30px; line-height: 2.2; font-size: 1.05em;">
                <li><span class="highlight">Queryï¼ˆæŸ¥è¯¢ï¼‰</span>ï¼šæˆ‘è¦æ‰¾ä»€ä¹ˆä¿¡æ¯ï¼Ÿ</li>
                <li><span class="highlight">Keyï¼ˆé”®ï¼‰</span>ï¼šæˆ‘èƒ½æä¾›ä»€ä¹ˆä¿¡æ¯ï¼Ÿ</li>
                <li><span class="highlight">Valueï¼ˆå€¼ï¼‰</span>ï¼šæˆ‘çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ</li>
            </ul>
            
            <div class="tip-box">
                <div class="tip-title">ğŸ’¡ å½¢è±¡ç±»æ¯”ï¼šå›¾ä¹¦é¦†æ£€ç´¢ç³»ç»Ÿ</div>
                <div class="tip-content">
                    â€¢ <strong>Queryï¼š</strong>è¯»è€…çš„æ£€ç´¢éœ€æ±‚ï¼ˆ"æˆ‘æƒ³æ‰¾å…³äºAIçš„ä¹¦"ï¼‰<br>
                    â€¢ <strong>Keyï¼š</strong>æ¯æœ¬ä¹¦çš„ç´¢å¼•æ ‡ç­¾ï¼ˆ"è¿™æœ¬ä¹¦æ˜¯å…³äºAIçš„"ï¼‰<br>
                    â€¢ <strong>Valueï¼š</strong>ä¹¦çš„å®é™…å†…å®¹ï¼ˆä¹¦ä¸­çš„çŸ¥è¯†ï¼‰<br>
                    <br>
                    é€šè¿‡å¯¹æ¯”Queryå’ŒKeyï¼Œæ‰¾åˆ°åŒ¹é…çš„ä¹¦ï¼Œç„¶åè·å–Valueï¼ˆå®é™…å†…å®¹ï¼‰
                </div>
            </div>
        </div>
        
        <!-- 2. è½¬æ¢è¿‡ç¨‹ -->
        <div class="section">
            <h2 class="section-title">äºŒã€ä»è¾“å…¥åˆ°Qã€Kã€Vçš„è½¬æ¢</h2>
            <p class="content-text">
                é€šè¿‡ä¸‰ä¸ª<span class="highlight">ç‹¬ç«‹çš„æƒé‡çŸ©é˜µ</span>è¿›è¡Œçº¿æ€§å˜æ¢ï¼š
            </p>
            
            <div class="qkv-transform">
                <div class="transform-box">
                    <div class="box-label">è¾“å…¥ X</div>
                    <div class="matrix-visual">
                        <div class="matrix-grid">
                            <div class="matrix-cell">0.5</div>
                            <div class="matrix-cell">-0.2</div>
                            <div class="matrix-cell">0.8</div>
                            <div class="matrix-cell">0.1</div>
                            <div class="matrix-cell">-0.3</div>
                            <div class="matrix-cell">0.6</div>
                            <div class="matrix-cell">0.4</div>
                            <div class="matrix-cell">0.2</div>
                        </div>
                        <div class="matrix-desc">è¾“å…¥å‘é‡<br>d_model=512</div>
                    </div>
                </div>
                
                <div class="operator">â†’</div>
                
                <div class="transform-box">
                    <div class="box-label" style="color: #1e88e5;">Query (Q)</div>
                    <div class="matrix-visual">
                        <div class="matrix-grid">
                            <div class="matrix-cell q">0.3</div>
                            <div class="matrix-cell q">0.7</div>
                            <div class="matrix-cell q">-0.1</div>
                            <div class="matrix-cell q">0.5</div>
                            <div class="matrix-cell q">0.2</div>
                            <div class="matrix-cell q">-0.4</div>
                            <div class="matrix-cell q">0.8</div>
                            <div class="matrix-cell q">0.1</div>
                        </div>
                        <div class="matrix-desc">Q = X Â· W_Q<br>d_k=64</div>
                    </div>
                </div>
                
                <div class="transform-box">
                    <div class="box-label" style="color: #43a047;">Key (K)</div>
                    <div class="matrix-visual">
                        <div class="matrix-grid">
                            <div class="matrix-cell k">0.6</div>
                            <div class="matrix-cell k">0.1</div>
                            <div class="matrix-cell k">0.4</div>
                            <div class="matrix-cell k">-0.2</div>
                            <div class="matrix-cell k">0.7</div>
                            <div class="matrix-cell k">0.3</div>
                            <div class="matrix-cell k">-0.5</div>
                            <div class="matrix-cell k">0.9</div>
                        </div>
                        <div class="matrix-desc">K = X Â· W_K<br>d_k=64</div>
                    </div>
                </div>
                
                <div class="transform-box">
                    <div class="box-label" style="color: #fb8c00;">Value (V)</div>
                    <div class="matrix-visual">
                        <div class="matrix-grid">
                            <div class="matrix-cell v">0.4</div>
                            <div class="matrix-cell v">-0.3</div>
                            <div class="matrix-cell v">0.9</div>
                            <div class="matrix-cell v">0.2</div>
                            <div class="matrix-cell v">0.5</div>
                            <div class="matrix-cell v">0.7</div>
                            <div class="matrix-cell v">-0.1</div>
                            <div class="matrix-cell v">0.6</div>
                        </div>
                        <div class="matrix-desc">V = X Â· W_V<br>d_v=64</div>
                    </div>
                </div>
            </div>
            
            <div class="formula-box">
                <div class="formula">Q = X Â· W_Q</div>
                <div class="formula">K = X Â· W_K</div>
                <div class="formula">V = X Â· W_V</div>
            </div>
        </div>
        
        <!-- 3. æƒé‡çŸ©é˜µè¯¦è§£ -->
        <div class="section">
            <h2 class="section-title">ä¸‰ã€ä¸‰ä¸ªæƒé‡çŸ©é˜µçš„ä½œç”¨</h2>
            
            <div class="weight-matrices">
                <div class="weight-card">
                    <div class="weight-title q">W_Qï¼ˆQueryæƒé‡ï¼‰</div>
                    <div class="weight-info">
                        <strong>å½¢çŠ¶ï¼š</strong>(d_model, d_k)<br>
                        <strong>å…¸å‹å€¼ï¼š</strong>(512, 64)<br>
                        <strong>ä½œç”¨ï¼š</strong>æå–"æŸ¥è¯¢ç‰¹å¾"<br>
                        <strong>å‚æ•°é‡ï¼š</strong>32,768ä¸ª<br>
                        <br>
                        å­¦ä¹ å¦‚ä½•ä»è¾“å…¥ä¸­æå–"æƒ³è¦å…³æ³¨ä»€ä¹ˆ"çš„ä¿¡æ¯
                    </div>
                </div>
                
                <div class="weight-card">
                    <div class="weight-title k">W_Kï¼ˆKeyæƒé‡ï¼‰</div>
                    <div class="weight-info">
                        <strong>å½¢çŠ¶ï¼š</strong>(d_model, d_k)<br>
                        <strong>å…¸å‹å€¼ï¼š</strong>(512, 64)<br>
                        <strong>ä½œç”¨ï¼š</strong>æå–"ç´¢å¼•ç‰¹å¾"<br>
                        <strong>å‚æ•°é‡ï¼š</strong>32,768ä¸ª<br>
                        <br>
                        å­¦ä¹ å¦‚ä½•ä»è¾“å…¥ä¸­æå–"èƒ½è¢«å…³æ³¨çš„ç‰¹å¾"
                    </div>
                </div>
                
                <div class="weight-card">
                    <div class="weight-title v">W_Vï¼ˆValueæƒé‡ï¼‰</div>
                    <div class="weight-info">
                        <strong>å½¢çŠ¶ï¼š</strong>(d_model, d_v)<br>
                        <strong>å…¸å‹å€¼ï¼š</strong>(512, 64)<br>
                        <strong>ä½œç”¨ï¼š</strong>æå–"å†…å®¹ç‰¹å¾"<br>
                        <strong>å‚æ•°é‡ï¼š</strong>32,768ä¸ª<br>
                        <br>
                        å­¦ä¹ å¦‚ä½•ä»è¾“å…¥ä¸­æå–"è¦ä¼ é€’çš„ä¿¡æ¯"
                    </div>
                </div>
            </div>
            
            <p class="content-text" style="margin-top: 25px;">
                <strong>å…³é”®ç‚¹ï¼š</strong>è¿™ä¸‰ä¸ªæƒé‡çŸ©é˜µæ˜¯<span class="highlight">ç‹¬ç«‹å¯å­¦ä¹ çš„å‚æ•°</span>ï¼Œ
                åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨å­¦ä¹ åˆ°æœ€ä¼˜çš„è½¬æ¢æ–¹å¼ã€‚
            </p>
        </div>
        
        <!-- 4. å®Œæ•´è®¡ç®—ç¤ºä¾‹ -->
        <div class="section">
            <h2 class="section-title">å››ã€å®Œæ•´è®¡ç®—ç¤ºä¾‹</h2>
            
            <div class="calculation-example">
                <div class="calc-title">ğŸ“Š è®¡ç®—"çˆ±"è¿™ä¸ªè¯çš„Qã€Kã€V</div>
                
                <div class="calc-step">
                    <div class="step-header">è¾“å…¥ï¼šè¯åµŒå…¥+ä½ç½®ç¼–ç </div>
                    <div class="step-content">
                        <div class="calc-matrix">
                            <div style="color: #5c6bc0; font-weight: bold; margin-bottom: 8px;">X (1Ã—4 ç®€åŒ–ç»´åº¦):</div>
                            <div>[0.5, -0.2, 0.8, 0.1]</div>
                        </div>
                    </div>
                </div>
                
                <div class="calc-step">
                    <div class="step-header">ç¬¬1æ­¥ï¼šè®¡ç®—Query</div>
                    <div class="step-content">
                        <div class="calc-matrix">
                            <div style="color: #1e88e5; font-weight: bold; margin-bottom: 8px;">W_Q (4Ã—4):</div>
                            <div>[0.2, 0.3, 0.1, 0.4]</div>
                            <div>[0.5, -0.1, 0.2, 0.3]</div>
                            <div>[0.1, 0.4, 0.3, 0.2]</div>
                            <div>[0.3, 0.2, 0.4, 0.1]</div>
                        </div>
                        <div style="margin: 15px 0; text-align: center; font-size: 1.2em; color: #555;">Ã—</div>
                        <div class="calc-matrix input">
                            <div style="color: #5c6bc0; font-weight: bold; margin-bottom: 8px;">X:</div>
                            <div>[0.5]</div>
                            <div>[-0.2]</div>
                            <div>[0.8]</div>
                            <div>[0.1]</div>
                        </div>
                        <div style="margin: 15px 0; text-align: center; font-size: 1.2em; color: #555;">=</div>
                        <div class="calc-matrix q">
                            <div style="color: #1e88e5; font-weight: bold; margin-bottom: 8px;">Q:</div>
                            <div>[0.27]</div>
                            <div>[0.36]</div>
                            <div>[0.29]</div>
                            <div>[0.45]</div>
                        </div>
                    </div>
                </div>
                
                <div class="calc-step">
                    <div class="step-header">ç¬¬2æ­¥ï¼šè®¡ç®—Key</div>
                    <div class="step-content">
                        åŒæ ·çš„æ–¹å¼ï¼Œä½¿ç”¨ W_K æƒé‡çŸ©é˜µè¿›è¡Œè®¡ç®—ï¼š<br>
                        <strong style="color: #43a047;">K = X Â· W_K = [0.18, 0.52, 0.31, 0.41]</strong>
                    </div>
                </div>
                
                <div class="calc-step">
                    <div class="step-header">ç¬¬3æ­¥ï¼šè®¡ç®—Value</div>
                    <div class="step-content">
                        åŒæ ·çš„æ–¹å¼ï¼Œä½¿ç”¨ W_V æƒé‡çŸ©é˜µè¿›è¡Œè®¡ç®—ï¼š<br>
                        <strong style="color: #fb8c00;">V = X Â· W_V = [0.35, 0.24, 0.48, 0.39]</strong>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 5. ç»´åº¦åˆ†æ -->
        <div class="section">
            <h2 class="section-title">äº”ã€ç»´åº¦å˜åŒ–åˆ†æ</h2>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>é˜¶æ®µ</th>
                        <th>çŸ©é˜µ</th>
                        <th>å½¢çŠ¶</th>
                        <th>è¯´æ˜</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>è¾“å…¥</strong></td>
                        <td>X</td>
                        <td>(seq_len, d_model)</td>
                        <td>ä¾‹ï¼š(10, 512)</td>
                    </tr>
                    <tr>
                        <td rowspan="3"><strong>æƒé‡</strong></td>
                        <td>W_Q</td>
                        <td>(d_model, d_k)</td>
                        <td>ä¾‹ï¼š(512, 64)</td>
                    </tr>
                    <tr>
                        <td>W_K</td>
                        <td>(d_model, d_k)</td>
                        <td>ä¾‹ï¼š(512, 64)</td>
                    </tr>
                    <tr>
                        <td>W_V</td>
                        <td>(d_model, d_v)</td>
                        <td>ä¾‹ï¼š(512, 64)</td>
                    </tr>
                    <tr>
                        <td rowspan="3"><strong>è¾“å‡º</strong></td>
                        <td>Q</td>
                        <td>(seq_len, d_k)</td>
                        <td>ä¾‹ï¼š(10, 64)</td>
                    </tr>
                    <tr>
                        <td>K</td>
                        <td>(seq_len, d_k)</td>
                        <td>ä¾‹ï¼š(10, 64)</td>
                    </tr>
                    <tr>
                        <td>V</td>
                        <td>(seq_len, d_v)</td>
                        <td>ä¾‹ï¼š(10, 64)</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="tip-box">
                <div class="tip-title">ğŸ“Œ ç»´åº¦å‹ç¼©çš„åŸå› </div>
                <div class="tip-content">
                    åŸå§‹ç»´åº¦512å‹ç¼©åˆ°64ï¼ˆåœ¨8ä¸ªå¤´çš„æƒ…å†µä¸‹ï¼‰ï¼š<br>
                    â€¢ å‡å°‘è®¡ç®—é‡ï¼š64Ã—64çš„çŸ©é˜µä¹˜æ³•æ¯”512Ã—512å¿«å¾ˆå¤š<br>
                    â€¢ å¤šå¤´æ³¨æ„åŠ›ï¼š8ä¸ªå¤´ Ã— 64ç»´ = 512ç»´ï¼Œä¿æŒæ€»ç»´åº¦ä¸å˜<br>
                    â€¢ å¼ºåˆ¶ä¿¡æ¯å‹ç¼©ï¼šè¿«ä½¿æ¨¡å‹å­¦ä¹ æœ€é‡è¦çš„ç‰¹å¾
                </div>
            </div>
        </div>
        
        <!-- 6. å‚æ•°é‡è®¡ç®— -->
        <div class="section">
            <h2 class="section-title">å…­ã€å‚æ•°é‡è®¡ç®—</h2>
            
            <div class="formula-box">
                <p style="color: #3f51b5; font-size: 1.2em; text-align: center; margin-bottom: 20px;">
                    <strong>å•å¤´æ³¨æ„åŠ›å‚æ•°é‡</strong>
                </p>
                <div class="formula">å‚æ•°é‡ = 3 Ã— (d_model Ã— d_k)</div>
                <div style="margin-top: 25px; color: #555; font-size: 1.05em; text-align: center;">
                    <strong>æ ‡å‡†é…ç½®è®¡ç®—ï¼š</strong><br>
                    d_model = 512, d_k = 64<br>
                    å‚æ•°é‡ = 3 Ã— (512 Ã— 64) = <span class="highlight">98,304 ä¸ªå‚æ•°</span>
                </div>
            </div>
            
            <p class="content-text">
                <strong>8å¤´æ³¨æ„åŠ›ï¼š</strong>98,304 Ã— 8 = <span class="highlight">786,432 ä¸ªå‚æ•°</span>ï¼ˆä»…Qã€Kã€Vè½¬æ¢ï¼‰
            </p>
        </div>
        
        <!-- 7. ä»£ç å®ç° -->
        <div class="section">
            <h2 class="section-title">ä¸ƒã€PyTorchä»£ç å®ç°</h2>
            
            <div class="code-block">
<span style="color: #82b1ff;">import</span> torch
<span style="color: #82b1ff;">import</span> torch.nn <span style="color: #82b1ff;">as</span> nn

<span style="color: #82b1ff;">class</span> <span style="color: #ffb74d;">QKVGeneration</span>(nn.Module):
    <span style="color: #82b1ff;">def</span> <span style="color: #ffb74d;">__init__</span>(self, d_model=512, d_k=64, d_v=64):
        super().__init__()
        
        <span style="color: #90a4ae;"># å®šä¹‰ä¸‰ä¸ªçº¿æ€§å˜æ¢å±‚</span>
        self.W_Q = nn.Linear(d_model, d_k, bias=<span style="color: #82b1ff;">False</span>)
        self.W_K = nn.Linear(d_model, d_k, bias=<span style="color: #82b1ff;">False</span>)
        self.W_V = nn.Linear(d_model, d_v, bias=<span style="color: #82b1ff;">False</span>)
    
    <span style="color: #82b1ff;">def</span> <span style="color: #ffb74d;">forward</span>(self, x):
        <span style="color: #90a4ae;"># x shape: (batch_size, seq_len, d_model)</span>
        
        <span style="color: #90a4ae;"># ç”ŸæˆQã€Kã€V</span>
        Q = self.W_Q(x)  <span style="color: #90a4ae;"># (batch, seq_len, d_k)</span>
        K = self.W_K(x)  <span style="color: #90a4ae;"># (batch, seq_len, d_k)</span>
        V = self.W_V(x)  <span style="color: #90a4ae;"># (batch, seq_len, d_v)</span>
        
        <span style="color: #82b1ff;">return</span> Q, K, V

<span style="color: #90a4ae;"># ä½¿ç”¨ç¤ºä¾‹</span>
batch_size = 32
seq_len = 10
d_model = 512
d_k = d_v = 64

<span style="color: #90a4ae;"># è¾“å…¥ï¼š(batch, seq_len, d_model)</span>
x = torch.randn(batch_size, seq_len, d_model)

<span style="color: #90a4ae;"># ç”ŸæˆQã€Kã€V</span>
qkv_layer = QKVGeneration(d_model, d_k, d_v)
Q, K, V = qkv_layer(x)

<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"è¾“å…¥ X: {x.shape}"</span>)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"Query: {Q.shape}"</span>)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"Key:   {K.shape}"</span>)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"Value: {V.shape}"</span>)
            </div>
        </div>
        
        <!-- æ€»ç»“ -->
        <div style="background: linear-gradient(135deg, #e8eaf6, #c5cae9); padding: 30px; border-radius: 15px; margin-top: 40px;">
            <h3 style="color: #3f51b5; text-align: center; margin-bottom: 20px; font-size: 1.5em;">
                âœ¨ æ ¸å¿ƒè¦ç‚¹æ€»ç»“
            </h3>
            <div style="color: #555; line-height: 2; font-size: 1.05em;">
                âœ“ Qã€Kã€Vé€šè¿‡ä¸‰ä¸ªç‹¬ç«‹çš„æƒé‡çŸ©é˜µä»è¾“å…¥Xçº¿æ€§å˜æ¢å¾—åˆ°<br>
                âœ“ Queryè´Ÿè´£"æŸ¥è¯¢"ï¼ŒKeyè´Ÿè´£"ç´¢å¼•"ï¼ŒValueè´Ÿè´£"å†…å®¹"<br>
                âœ“ ç»´åº¦ä»512å‹ç¼©åˆ°64ï¼Œå‡å°‘è®¡ç®—é‡å¹¶å¼ºåˆ¶ç‰¹å¾æå–<br>
                âœ“ ä¸‰ä¸ªæƒé‡çŸ©é˜µæ˜¯å¯å­¦ä¹ å‚æ•°ï¼Œè®­ç»ƒä¸­è‡ªåŠ¨ä¼˜åŒ–<br>
                âœ“ è¿™æ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„ç¬¬ä¸€æ­¥ï¼Œä¸ºåç»­è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°åšå‡†å¤‡
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; color: #999; font-size: 0.9em;">
            <p>Â© 2025 QKVçŸ©é˜µç”Ÿæˆè¯¦è§£ - Transformerç³»åˆ—æ•™ç¨‹</p>
        </div>
    </div>
</body>
</html>