<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformeræ¶æ„åŸç† - æŠ€æœ¯å¡ç‰‡</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .architecture-diagram {
            text-align: center;
            margin: 30px 0;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 5px solid #667eea;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
        }

        .card-icon {
            width: 24px;
            height: 24px;
            margin-right: 10px;
            background: #667eea;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .card p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .formula {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .highlight {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }

        .attention-visual {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .layer-stack {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }

        .layer-box {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 15px;
            min-width: 120px;
            text-align: center;
            font-weight: 600;
            color: #667eea;
        }

        .arrow {
            font-size: 24px;
            color: #667eea;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }

        .detail-section {
            margin: 30px 0;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .detail-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Transformeræ¶æ„åŸç†</h1>
            <p>æ·±åº¦å­¦ä¹ é©å‘½æ€§æ¶æ„ - æ³¨æ„åŠ›æœºåˆ¶çš„å®Œç¾å®ç°</p>
        </div>

        <div class="content">
            <div class="tabs">
                <button class="tab active" onclick="showTab('architecture')">æ¶æ„æ¦‚è§ˆ</button>
                <button class="tab" onclick="showTab('attention')">æ³¨æ„åŠ›æœºåˆ¶</button>
                <button class="tab" onclick="showTab('components')">æ ¸å¿ƒç»„ä»¶</button>
                <button class="tab" onclick="showTab('implementation')">å®ç°ç»†èŠ‚</button>
            </div>

            <!-- æ¶æ„æ¦‚è§ˆ -->
            <div id="architecture" class="tab-content active">
                <div class="architecture-diagram">
                    <svg width="800" height="600" viewBox="0 0 800 600">
                        <!-- ç¼–ç å™¨ -->
                        <rect x="50" y="100" width="300" height="400" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="10"/>
                        <text x="200" y="90" text-anchor="middle" font-size="18" font-weight="bold" fill="#1976d2">ç¼–ç å™¨ (Encoder)</text>
                        
                        <!-- ç¼–ç å™¨å±‚ -->
                        <rect x="70" y="120" width="260" height="60" fill="#bbdefb" stroke="#1976d2" rx="5"/>
                        <text x="200" y="155" text-anchor="middle" font-size="14" fill="#1976d2">å¤šå¤´è‡ªæ³¨æ„åŠ›</text>
                        
                        <rect x="70" y="200" width="260" height="40" fill="#90caf9" stroke="#1976d2" rx="5"/>
                        <text x="200" y="225" text-anchor="middle" font-size="14" fill="#1976d2">å‰é¦ˆç½‘ç»œ</text>
                        
                        <rect x="70" y="260" width="260" height="60" fill="#bbdefb" stroke="#1976d2" rx="5"/>
                        <text x="200" y="295" text-anchor="middle" font-size="14" fill="#1976d2">å¤šå¤´è‡ªæ³¨æ„åŠ›</text>
                        
                        <rect x="70" y="340" width="260" height="40" fill="#90caf9" stroke="#1976d2" rx="5"/>
                        <text x="200" y="365" text-anchor="middle" font-size="14" fill="#1976d2">å‰é¦ˆç½‘ç»œ</text>
                        
                        <text x="200" y="430" text-anchor="middle" font-size="12" fill="#666">... Nå±‚</text>

                        <!-- è§£ç å™¨ -->
                        <rect x="450" y="100" width="300" height="400" fill="#fff3e0" stroke="#f57c00" stroke-width="2" rx="10"/>
                        <text x="600" y="90" text-anchor="middle" font-size="18" font-weight="bold" fill="#f57c00">è§£ç å™¨ (Decoder)</text>
                        
                        <!-- è§£ç å™¨å±‚ -->
                        <rect x="470" y="120" width="260" height="50" fill="#ffcc02" stroke="#f57c00" rx="5"/>
                        <text x="600" y="150" text-anchor="middle" font-size="12" fill="#f57c00">æ©ç å¤šå¤´è‡ªæ³¨æ„åŠ›</text>
                        
                        <rect x="470" y="190" width="260" height="50" fill="#ffb74d" stroke="#f57c00" rx="5"/>
                        <text x="600" y="220" text-anchor="middle" font-size="12" fill="#f57c00">ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›</text>
                        
                        <rect x="470" y="260" width="260" height="40" fill="#ff9800" stroke="#f57c00" rx="5"/>
                        <text x="600" y="285" text-anchor="middle" font-size="14" fill="#f57c00">å‰é¦ˆç½‘ç»œ</text>
                        
                        <rect x="470" y="320" width="260" height="50" fill="#ffcc02" stroke="#f57c00" rx="5"/>
                        <text x="600" y="350" text-anchor="middle" font-size="12" fill="#f57c00">æ©ç å¤šå¤´è‡ªæ³¨æ„åŠ›</text>
                        
                        <text x="600" y="430" text-anchor="middle" font-size="12" fill="#666">... Nå±‚</text>

                        <!-- è¿æ¥ç®­å¤´ -->
                        <path d="M 350 300 L 450 220" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
                        
                        <!-- è¾“å…¥è¾“å‡º -->
                        <rect x="70" y="520" width="260" height="30" fill="#e8f5e8" stroke="#4caf50" rx="5"/>
                        <text x="200" y="540" text-anchor="middle" font-size="14" fill="#4caf50">è¾“å…¥åµŒå…¥ + ä½ç½®ç¼–ç </text>
                        
                        <rect x="470" y="520" width="260" height="30" fill="#fce4ec" stroke="#e91e63" rx="5"/>
                        <text x="600" y="540" text-anchor="middle" font-size="14" fill="#e91e63">è¾“å‡ºæ¦‚ç‡åˆ†å¸ƒ</text>

                        <!-- ç®­å¤´æ ‡è®°å®šä¹‰ -->
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
                            </marker>
                        </defs>
                    </svg>
                </div>

                <div class="grid">
                    <div class="card">
                        <h3><span class="card-icon">ğŸ—ï¸</span>æ•´ä½“æ¶æ„</h3>
                        <p>Transformeré‡‡ç”¨<span class="highlight">ç¼–ç å™¨-è§£ç å™¨</span>æ¶æ„ï¼Œå®Œå…¨åŸºäºæ³¨æ„åŠ›æœºåˆ¶ï¼Œæ‘’å¼ƒäº†å¾ªç¯å’Œå·ç§¯ç»“æ„ã€‚</p>
                        <p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
                        <ul style="margin-left: 20px; color: #666;">
                            <li>å¹¶è¡Œè®¡ç®—èƒ½åŠ›å¼º</li>
                            <li>é•¿è·ç¦»ä¾èµ–å»ºæ¨¡ä¼˜ç§€</li>
                            <li>è®­ç»ƒæ•ˆç‡é«˜</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ”„</span>ç¼–ç å™¨</h3>
                        <p>ç”±N=6ä¸ªç›¸åŒå±‚ç»„æˆï¼Œæ¯å±‚åŒ…å«ï¼š</p>
                        <div class="formula">
                        1. å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶<br>
                        2. ä½ç½®å‰é¦ˆç½‘ç»œ<br>
                        3. æ®‹å·®è¿æ¥ + å±‚å½’ä¸€åŒ–
                        </div>
                        <p>è¾“å‡ºç»´åº¦ï¼šd_model = 512</p>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ¯</span>è§£ç å™¨</h3>
                        <p>åŒæ ·ç”±N=6ä¸ªå±‚ç»„æˆï¼Œæ¯å±‚åŒ…å«ï¼š</p>
                        <div class="formula">
                        1. æ©ç å¤šå¤´è‡ªæ³¨æ„åŠ›<br>
                        2. ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›<br>
                        3. ä½ç½®å‰é¦ˆç½‘ç»œ<br>
                        4. æ®‹å·®è¿æ¥ + å±‚å½’ä¸€åŒ–
                        </div>
                        <p>æ”¯æŒè‡ªå›å½’ç”Ÿæˆ</p>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ“</span>ä½ç½®ç¼–ç </h3>
                        <p>ç”±äºæ²¡æœ‰å¾ªç¯ç»“æ„ï¼Œéœ€è¦æ˜¾å¼æ·»åŠ ä½ç½®ä¿¡æ¯ï¼š</p>
                        <div class="formula">
                        PE(pos,2i) = sin(pos/10000^(2i/d_model))<br>
                        PE(pos,2i+1) = cos(pos/10000^(2i/d_model))
                        </div>
                        <p>ä½¿æ¨¡å‹èƒ½å¤Ÿç†è§£åºåˆ—ä¸­çš„ä½ç½®å…³ç³»</p>
                    </div>
                </div>
            </div>

            <!-- æ³¨æ„åŠ›æœºåˆ¶ -->
            <div id="attention" class="tab-content">
                <div class="attention-visual">
                    <h3>ğŸ¯ æ³¨æ„åŠ›æœºåˆ¶æ ¸å¿ƒå…¬å¼</h3>
                    <div class="formula" style="font-size: 18px; text-align: center; margin: 20px 0;">
                        Attention(Q,K,V) = softmax(QK^T/âˆšd_k)V
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <h3><span class="card-icon">ğŸ”</span>è‡ªæ³¨æ„åŠ›æœºåˆ¶</h3>
                        <p><span class="highlight">Self-Attention</span>å…è®¸åºåˆ—ä¸­çš„æ¯ä¸ªä½ç½®å…³æ³¨åºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®ã€‚</p>
                        <div class="formula">
                        Q = XW^Q  (æŸ¥è¯¢çŸ©é˜µ)<br>
                        K = XW^K  (é”®çŸ©é˜µ)<br>
                        V = XW^V  (å€¼çŸ©é˜µ)
                        </div>
                        <p>é€šè¿‡Qã€Kçš„ç‚¹ç§¯è®¡ç®—æ³¨æ„åŠ›æƒé‡ï¼Œç”¨äºåŠ æƒVã€‚</p>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ­</span>å¤šå¤´æ³¨æ„åŠ›</h3>
                        <p>å°†æ³¨æ„åŠ›æœºåˆ¶å¹¶è¡Œè¿è¡Œh=8æ¬¡ï¼Œæ¯æ¬¡ä½¿ç”¨ä¸åŒçš„çº¿æ€§æŠ•å½±ï¼š</p>
                        <div class="formula">
                        MultiHead(Q,K,V) = Concat(head_1,...,head_h)W^O<br>
                        head_i = Attention(QW_i^Q, KW_i^K, VW_i^V)
                        </div>
                        <p>å…è®¸æ¨¡å‹å…³æ³¨ä¸åŒä½ç½®çš„ä¸åŒè¡¨ç¤ºå­ç©ºé—´ã€‚</p>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸª</span>æ©ç æ³¨æ„åŠ›</h3>
                        <p>åœ¨è§£ç å™¨ä¸­ä½¿ç”¨ï¼Œé˜²æ­¢ä½ç½®iå…³æ³¨åˆ°ä½ç½®iä¹‹åçš„ä¿¡æ¯ï¼š</p>
                        <div class="formula">
                        mask_ij = -âˆ if j > i<br>
                        mask_ij = 0 if j â‰¤ i
                        </div>
                        <p>ç¡®ä¿ç”Ÿæˆè¿‡ç¨‹çš„è‡ªå›å½’ç‰¹æ€§ã€‚</p>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ”—</span>äº¤å‰æ³¨æ„åŠ›</h3>
                        <p>è§£ç å™¨ä¸­çš„ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›ï¼š</p>
                        <div class="formula">
                        Q = è§£ç å™¨éšè—çŠ¶æ€<br>
                        K,V = ç¼–ç å™¨è¾“å‡º
                        </div>
                        <p>å…è®¸è§£ç å™¨å…³æ³¨è¾“å…¥åºåˆ—çš„æ‰€æœ‰ä½ç½®ã€‚</p>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>æ³¨æ„åŠ›è®¡ç®—æµç¨‹</h3>
                    <div class="layer-stack">
                        <div class="layer-box">è¾“å…¥åºåˆ—<br>X</div>
                        <span class="arrow">â†’</span>
                        <div class="layer-box">çº¿æ€§å˜æ¢<br>Q,K,V</div>
                        <span class="arrow">â†’</span>
                        <div class="layer-box">æ³¨æ„åŠ›è®¡ç®—<br>QK^T</div>
                        <span class="arrow">â†’</span>
                        <div class="layer-box">Softmax<br>å½’ä¸€åŒ–</div>
                        <span class="arrow">â†’</span>
                        <div class="layer-box">åŠ æƒæ±‚å’Œ<br>Ã—V</div>
                    </div>
                </div>
            </div>

            <!-- æ ¸å¿ƒç»„ä»¶ -->
            <div id="components" class="tab-content">
                <div class="grid">
                    <div class="card">
                        <h3><span class="card-icon">ğŸ§ </span>å‰é¦ˆç½‘ç»œ</h3>
                        <p>æ¯ä¸ªç¼–ç å™¨å’Œè§£ç å™¨å±‚éƒ½åŒ…å«ä¸€ä¸ªå…¨è¿æ¥å‰é¦ˆç½‘ç»œï¼š</p>
                        <div class="formula">
                        FFN(x) = max(0, xW_1 + b_1)W_2 + b_2
                        </div>
                        <p>å†…éƒ¨ç»´åº¦ï¼šd_ff = 2048ï¼Œè¾“å‡ºç»´åº¦ï¼šd_model = 512</p>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ”„</span>æ®‹å·®è¿æ¥</h3>
                        <p>æ¯ä¸ªå­å±‚å‘¨å›´éƒ½æœ‰æ®‹å·®è¿æ¥ï¼Œç„¶åè¿›è¡Œå±‚å½’ä¸€åŒ–ï¼š</p>
                        <div class="formula">
                        LayerNorm(x + Sublayer(x))
                        </div>
                        <p>æœ‰åŠ©äºè®­ç»ƒæ·±å±‚ç½‘ç»œï¼Œç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</p>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ“</span>å±‚å½’ä¸€åŒ–</h3>
                        <p>å¯¹æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾ç»´åº¦è¿›è¡Œå½’ä¸€åŒ–ï¼š</p>
                        <div class="formula">
                        LayerNorm(x) = Î³(x-Î¼)/Ïƒ + Î²<br>
                        Î¼ = mean(x), Ïƒ = std(x)
                        </div>
                        <p>ç¨³å®šè®­ç»ƒè¿‡ç¨‹ï¼ŒåŠ é€Ÿæ”¶æ•›ã€‚</p>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ“</span>è¯åµŒå…¥</h3>
                        <p>å°†è¾“å…¥å’Œè¾“å‡ºtokenè½¬æ¢ä¸ºd_modelç»´å‘é‡ï¼š</p>
                        <div class="formula">
                        Embedding: vocab_size â†’ d_model<br>
                        æƒé‡å…±äº«ï¼šè¾“å…¥ã€è¾“å‡ºã€é¢„softmaxçº¿æ€§å˜æ¢
                        </div>
                        <p>åµŒå…¥æƒé‡ä¹˜ä»¥âˆšd_modelè¿›è¡Œç¼©æ”¾ã€‚</p>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>ç»„ä»¶åä½œæµç¨‹</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>ç»„ä»¶</th>
                                <th>åŠŸèƒ½</th>
                                <th>è¾“å…¥</th>
                                <th>è¾“å‡º</th>
                                <th>å‚æ•°é‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>è¯åµŒå…¥</td>
                                <td>token â†’ å‘é‡</td>
                                <td>tokenåºåˆ—</td>
                                <td>d_modelç»´å‘é‡</td>
                                <td>vocab_size Ã— d_model</td>
                            </tr>
                            <tr>
                                <td>ä½ç½®ç¼–ç </td>
                                <td>æ·»åŠ ä½ç½®ä¿¡æ¯</td>
                                <td>åµŒå…¥å‘é‡</td>
                                <td>ä½ç½®æ„ŸçŸ¥å‘é‡</td>
                                <td>0 (å›ºå®šå‡½æ•°)</td>
                            </tr>
                            <tr>
                                <td>å¤šå¤´æ³¨æ„åŠ›</td>
                                <td>åºåˆ—å»ºæ¨¡</td>
                                <td>Q,K,VçŸ©é˜µ</td>
                                <td>æ³¨æ„åŠ›è¾“å‡º</td>
                                <td>4 Ã— d_modelÂ²</td>
                            </tr>
                            <tr>
                                <td>å‰é¦ˆç½‘ç»œ</td>
                                <td>éçº¿æ€§å˜æ¢</td>
                                <td>æ³¨æ„åŠ›è¾“å‡º</td>
                                <td>å˜æ¢åå‘é‡</td>
                                <td>2 Ã— d_model Ã— d_ff</td>
                            </tr>
                            <tr>
                                <td>å±‚å½’ä¸€åŒ–</td>
                                <td>ç‰¹å¾å½’ä¸€åŒ–</td>
                                <td>ä»»æ„å‘é‡</td>
                                <td>å½’ä¸€åŒ–å‘é‡</td>
                                <td>2 Ã— d_model</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- å®ç°ç»†èŠ‚ -->
            <div id="implementation" class="tab-content">
                <div class="detail-section">
                    <h3>PyTorchå®ç°ç¤ºä¾‹</h3>
                    <div class="code-block">
import torch
import torch.nn as nn
import torch.nn.functional as F
import math

class MultiHeadAttention(nn.Module):
    def __init__(self, d_model, n_heads):
        super().__init__()
        self.d_model = d_model
        self.n_heads = n_heads
        self.d_k = d_model // n_heads
        
        self.W_q = nn.Linear(d_model, d_model)
        self.W_k = nn.Linear(d_model, d_model)
        self.W_v = nn.Linear(d_model, d_model)
        self.W_o = nn.Linear(d_model, d_model)
        
    def forward(self, query, key, value, mask=None):
        batch_size = query.size(0)
        
        # çº¿æ€§å˜æ¢å¹¶é‡å¡‘ä¸ºå¤šå¤´
        Q = self.W_q(query).view(batch_size, -1, self.n_heads, self.d_k).transpose(1, 2)
        K = self.W_k(key).view(batch_size, -1, self.n_heads, self.d_k).transpose(1, 2)
        V = self.W_v(value).view(batch_size, -1, self.n_heads, self.d_k).transpose(1, 2)
        
        # è®¡ç®—æ³¨æ„åŠ›
        attention = self.scaled_dot_product_attention(Q, K, V, mask)
        
        # åˆå¹¶å¤šå¤´
        attention = attention.transpose(1, 2).contiguous().view(
            batch_size, -1, self.d_model)
        
        return self.W_o(attention)
    
    def scaled_dot_product_attention(self, Q, K, V, mask=None):
        scores = torch.matmul(Q, K.transpose(-2, -1)) / math.sqrt(self.d_k)
        
        if mask is not None:
            scores = scores.masked_fill(mask == 0, -1e9)
        
        attention_weights = F.softmax(scores, dim=-1)
        return torch.matmul(attention_weights, V)
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <h3><span class="card-icon">âš™ï¸</span>è®­ç»ƒæŠ€å·§</h3>
                        <p><strong>å­¦ä¹ ç‡è°ƒåº¦ï¼š</strong></p>
                        <div class="formula">
                        lrate = d_model^(-0.5) Ã— min(step^(-0.5), step Ã— warmup_steps^(-1.5))
                        </div>
                        <p><strong>å…¶ä»–æŠ€å·§ï¼š</strong></p>
                        <ul style="margin-left: 20px; color: #666;">
                            <li>Dropout: 0.1</li>
                            <li>Label Smoothing: 0.1</li>
                            <li>Warmup Steps: 4000</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ“Š</span>æ¨¡å‹è§„æ¨¡</h3>
                        <p><strong>Transformer Baseï¼š</strong></p>
                        <ul style="margin-left: 20px; color: #666;">
                            <li>å±‚æ•°ï¼šN = 6</li>
                            <li>æ¨¡å‹ç»´åº¦ï¼šd_model = 512</li>
                            <li>å‰é¦ˆç»´åº¦ï¼šd_ff = 2048</li>
                            <li>æ³¨æ„åŠ›å¤´æ•°ï¼šh = 8</li>
                            <li>å‚æ•°é‡ï¼š65M</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸš€</span>ä¼˜åŒ–ç­–ç•¥</h3>
                        <p><strong>è®¡ç®—ä¼˜åŒ–ï¼š</strong></p>
                        <ul style="margin-left: 20px; color: #666;">
                            <li>å¹¶è¡Œè®¡ç®—æ³¨æ„åŠ›</li>
                            <li>ç¼“å­˜K,VçŸ©é˜µ</li>
                            <li>æ¢¯åº¦ç´¯ç§¯</li>
                            <li>æ··åˆç²¾åº¦è®­ç»ƒ</li>
                        </ul>
                        <p><strong>å†…å­˜ä¼˜åŒ–ï¼š</strong></p>
                        <ul style="margin-left: 20px; color: #666;">
                            <li>æ¢¯åº¦æ£€æŸ¥ç‚¹</li>
                            <li>åŠ¨æ€padding</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h3><span class="card-icon">ğŸ¯</span>åº”ç”¨åœºæ™¯</h3>
                        <p><strong>NLPä»»åŠ¡ï¼š</strong></p>
                        <ul style="margin-left: 20px; color: #666;">
                            <li>æœºå™¨ç¿»è¯‘</li>
                            <li>æ–‡æœ¬æ‘˜è¦</li>
                            <li>é—®ç­”ç³»ç»Ÿ</li>
                            <li>è¯­è¨€å»ºæ¨¡</li>
                        </ul>
                        <p><strong>æ‰©å±•åº”ç”¨ï¼š</strong></p>
                        <ul style="margin-left: 20px; color: #666;">
                            <li>Vision Transformer</li>
                            <li>è¯­éŸ³è¯†åˆ«</li>
                            <li>è›‹ç™½è´¨ç»“æ„é¢„æµ‹</li>
                        </ul>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>æ€§èƒ½å¯¹æ¯”</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>æ¨¡å‹</th>
                                <th>BLEU (EN-DE)</th>
                                <th>BLEU (EN-FR)</th>
                                <th>è®­ç»ƒæ—¶é—´</th>
                                <th>å‚æ•°é‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>RNN + Attention</td>
                                <td>24.6</td>
                                <td>39.2</td>
                                <td>12å¤©</td>
                                <td>~100M</td>
                            </tr>
                            <tr>
                                <td>ConvS2S</td>
                                <td>25.2</td>
                                <td>40.5</td>
                                <td>9å¤©</td>
                                <td>~100M</td>
                            </tr>
                            <tr>
                                <td><strong>Transformer Base</strong></td>
                                <td><strong>27.3</strong></td>
                                <td><strong>38.1</strong></td>
                                <td><strong>3.5å¤©</strong></td>
                                <td><strong>65M</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Transformer Big</strong></td>
                                <td><strong>28.4</strong></td>
                                <td><strong>41.8</strong></td>
                                <td><strong>3.5å¤©</strong></td>
                                <td><strong>213M</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾é¡µçš„activeç±»
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µå†…å®¹
            document.getElementById(tabName).classList.add('active');
            
            // æ·»åŠ activeç±»åˆ°ç‚¹å‡»çš„æ ‡ç­¾é¡µ
            event.target.classList.add('active');
        }
    </script>
</body>
</html>