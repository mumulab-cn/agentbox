<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS AI éº»å°†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <style>
        .mahjong-tile {
            width: 60px;
            height: 80px;
            background: linear-gradient(145deg, #f0f0f0, #d0d0d0);
            border: 2px solid #888;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 10px;
            text-align: center;
            margin: 2px;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .mahjong-tile:hover {
            transform: translateY(-5px) rotate(2deg);
            box-shadow: 3px 3px 8px rgba(0,0,0,0.4);
            animation: tileHover 0.3s ease;
        }
        
        .mahjong-tile.selected {
            background: linear-gradient(145deg, #ffd700, #ffb347);
            border-color: #ff6b35;
            transform: translateY(-3px) scale(1.05);
            animation: tileSelect 0.5s ease;
        }
        
        .mahjong-tile.new-tile {
            animation: newTileAppear 0.8s ease;
        }
        
        .meld-complete {
            animation: meldComplete 1s ease;
        }
        
        .win-celebration {
            animation: winCelebration 2s ease infinite;
        }
        
        @keyframes tileHover {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-8px) rotate(3deg); }
            100% { transform: translateY(-5px) rotate(2deg); }
        }
        
        @keyframes tileSelect {
            0% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-5px) scale(1.1); }
            100% { transform: translateY(-3px) scale(1.05); }
        }
        
        @keyframes newTileAppear {
            0% { 
                opacity: 0; 
                transform: scale(0) rotate(180deg); 
            }
            50% { 
                opacity: 0.7; 
                transform: scale(1.2) rotate(90deg); 
            }
            100% { 
                opacity: 1; 
                transform: scale(1) rotate(0deg); 
            }
        }
        
        @keyframes meldComplete {
            0% { transform: scale(1); }
            25% { transform: scale(1.1) rotate(5deg); }
            50% { transform: scale(1.05) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(3deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        @keyframes winCelebration {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(5deg); }
            50% { transform: scale(1.05) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(3deg); }
        }
        
        .floating-score {
            position: fixed;
            z-index: 1000;
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: floatingScore 2s ease-out forwards;
            pointer-events: none;
        }
        
        @keyframes floatingScore {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }
        
        .tile-symbol {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 2px;
        }
        
        .tile-name {
            font-size: 8px;
            line-height: 1;
        }
        
        .hand-area {
            min-height: 100px;
            background: linear-gradient(135deg, #2d5a27, #4a7c59);
            border: 3px dashed #8fbc8f;
            border-radius: 12px;
        }
        
        .meld-area {
            min-height: 80px;
            background: linear-gradient(135deg, #8b4513, #a0522d);
            border: 2px solid #daa520;
            border-radius: 8px;
        }
        
        .game-board {
            background: linear-gradient(45deg, #228b22, #32cd32);
            border-radius: 20px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.3);
        }
        
        .score-display {
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            color: white;
            border-radius: 10px;
            padding: 10px;
        }
        
        /* AWSæœåŠ¡åˆ†ç±»é¢œè‰² */
        .compute { background: linear-gradient(145deg, #ff6b35, #f7931e); }
        .storage { background: linear-gradient(145deg, #4285f4, #34a853); }
        .database { background: linear-gradient(145deg, #9c27b0, #673ab7); }
        .ai-ml { background: linear-gradient(145deg, #e91e63, #f44336); }
        .networking { background: linear-gradient(145deg, #00bcd4, #009688); }
        .security { background: linear-gradient(145deg, #795548, #607d8b); }
        .analytics { background: linear-gradient(145deg, #ff9800, #ffc107); }
        .devtools { background: linear-gradient(145deg, #8bc34a, #4caf50); }
        .iot { background: linear-gradient(145deg, #3f51b5, #2196f3); }
    </style>
</head>
<body class="bg-gradient-to-br from-green-800 to-green-600 min-h-screen">
    <header class="text-center py-6 text-white">
        <h1 class="text-4xl font-bold mb-2">ğŸ€„ AWS AI éº»å°† ğŸ€„</h1>
        <p class="text-lg">ç”¨AWSæœåŠ¡ç»„åˆèƒ¡ç‰Œï¼Œæ„å»ºå®Œæ•´çš„äº‘æ¶æ„è§£å†³æ–¹æ¡ˆï¼</p>
    </header>

    <div class="container mx-auto px-4">
        <!-- æ¸¸æˆçŠ¶æ€æ  -->
        <div class="flex justify-between items-center mb-6">
            <div class="score-display">
                <h3 class="font-bold">å½“å‰åˆ†æ•°</h3>
                <div id="score" class="text-2xl">0</div>
            </div>
            <div class="score-display">
                <h3 class="font-bold">å‰©ä½™ç‰Œæ•°</h3>
                <div id="remaining-tiles" class="text-2xl">144</div>
            </div>
            <div class="score-display">
                <h3 class="font-bold">å›åˆ</h3>
                <div id="round" class="text-2xl">1</div>
            </div>
        </div>

        <!-- ä¸»æ¸¸æˆåŒºåŸŸ -->
        <div class="game-board p-6 mb-6">
            <!-- å·²ç»„åˆçš„ç‰Œç»„åŒºåŸŸ -->
            <div class="mb-6">
                <h3 class="text-white text-xl font-bold mb-3">ğŸ† å·²å®Œæˆçš„æ¶æ„ç»„åˆ</h3>
                <div id="completed-melds" class="flex flex-wrap gap-4">
                    <!-- å®Œæˆçš„ç»„åˆå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                </div>
            </div>

            <!-- æ‰‹ç‰ŒåŒºåŸŸ -->
            <div class="mb-6">
                <h3 class="text-white text-xl font-bold mb-3">ğŸ¯ ä½ çš„æ‰‹ç‰Œ</h3>
                <div id="player-hand" class="hand-area p-4 flex flex-wrap gap-2">
                    <!-- ç©å®¶æ‰‹ç‰Œå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                </div>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="text-center mb-6">
                <button id="draw-tile" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg mr-4 transition-all duration-300 transform hover:scale-105">
                    æ‘¸ç‰Œ
                </button>
                <button id="check-win" class="bg-green-500 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg mr-4 transition-all duration-300 transform hover:scale-105">
                    æ£€æŸ¥èƒ¡ç‰Œ
                </button>
                <button id="reset-game" class="bg-red-500 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105">
                    é‡æ–°å¼€å§‹
                </button>
            </div>
        </div>

        <!-- æ¸¸æˆè¯´æ˜ -->
        <div class="bg-white rounded-lg p-6 mb-6">
            <h3 class="text-2xl font-bold mb-4 text-gray-800">ğŸ® æ¸¸æˆè§„åˆ™</h3>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-bold text-lg mb-2 text-blue-600">åŸºæœ¬è§„åˆ™</h4>
                    <ul class="list-disc list-inside space-y-1 text-gray-700">
                        <li>æ¯æ¬¡æ‘¸ä¸€å¼ AWSæœåŠ¡ç‰Œ</li>
                        <li>ç»„æˆ3å¼ ç›¸åŒæœåŠ¡çš„"åˆ»å­"æˆ–è¿ç»­æœåŠ¡çš„"é¡ºå­"</li>
                        <li>æ”¶é›†4ä¸ªç»„åˆ+1å¯¹çœ¼ç‰Œå³å¯èƒ¡ç‰Œ</li>
                        <li>ä¸åŒçš„AWSæ¶æ„ç»„åˆæœ‰ä¸åŒåˆ†æ•°</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-2 text-green-600">ç‰¹æ®Šç»„åˆ</h4>
                    <ul class="list-disc list-inside space-y-1 text-gray-700">
                        <li>ğŸ”¥ å…¨AIæœåŠ¡èƒ¡ç‰Œï¼š+500åˆ†</li>
                        <li>ğŸ’¾ å…¨å­˜å‚¨æœåŠ¡èƒ¡ç‰Œï¼š+300åˆ†</li>
                        <li>ğŸ”’ å…¨å®‰å…¨æœåŠ¡èƒ¡ç‰Œï¼š+400åˆ†</li>
                        <li>âš¡ å…¨è®¡ç®—æœåŠ¡èƒ¡ç‰Œï¼š+350åˆ†</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
        <div id="game-result" class="text-center mb-6"></div>
    </div>

    <footer class="text-center py-4 text-white">
        <p>&copy; 2024 AWS AI éº»å°† - å­¦ä¹ äº‘æœåŠ¡çš„è¶£å‘³æ–¹å¼</p>
    </footer>

    <script>
        // éŸ³æ•ˆå‡½æ•°
        function playSound(type) {
            // ä½¿ç”¨Web Audio APIåˆ›å»ºç®€å•éŸ³æ•ˆ
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            let frequency, duration;
            switch(type) {
                case 'select':
                    frequency = 800;
                    duration = 0.1;
                    break;
                case 'meld':
                    frequency = 1200;
                    duration = 0.3;
                    break;
                case 'draw':
                    frequency = 600;
                    duration = 0.2;
                    break;
                case 'win':
                    // èƒœåˆ©éŸ³æ•ˆ - æ’­æ”¾ä¸€ä¸ªä¸Šå‡çš„éŸ³è°ƒ
                    playWinSound(audioContext);
                    return;
                default:
                    return;
            }
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }
        
        function playWinSound(audioContext) {
            const frequencies = [523, 659, 784, 1047]; // C, E, G, C (å¤§è°ƒå’Œå¼¦)
            frequencies.forEach((freq, index) => {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                }, index * 100);
            });
        }
        
        // æ˜¾ç¤ºæµ®åŠ¨åˆ†æ•°åŠ¨ç”»
        function showFloatingScore(score, x, y) {
            const floatingScore = $(`<div class="floating-score">+${score}</div>`);
            floatingScore.css({
                left: x + 'px',
                top: y + 'px'
            });
            
            $('body').append(floatingScore);
            
            setTimeout(() => {
                floatingScore.remove();
            }, 2000);
        }

        // AWSæœåŠ¡ç‰Œåº“å®šä¹‰
        const awsTiles = [
            // è®¡ç®—æœåŠ¡ (ä¸‡)
            { id: 'ec2-1', name: 'EC2', category: 'compute', symbol: 'ä¸€', type: 'ä¸‡', count: 4 },
            { id: 'lambda-2', name: 'Lambda', category: 'compute', symbol: 'äºŒ', type: 'ä¸‡', count: 4 },
            { id: 'ecs-3', name: 'ECS', category: 'compute', symbol: 'ä¸‰', type: 'ä¸‡', count: 4 },
            { id: 'eks-4', name: 'EKS', category: 'compute', symbol: 'å››', type: 'ä¸‡', count: 4 },
            { id: 'batch-5', name: 'Batch', category: 'compute', symbol: 'äº”', type: 'ä¸‡', count: 4 },
            { id: 'fargate-6', name: 'Fargate', category: 'compute', symbol: 'å…­', type: 'ä¸‡', count: 4 },
            { id: 'lightsail-7', name: 'Lightsail', category: 'compute', symbol: 'ä¸ƒ', type: 'ä¸‡', count: 4 },
            { id: 'outposts-8', name: 'Outposts', category: 'compute', symbol: 'å…«', type: 'ä¸‡', count: 4 },
            { id: 'wavelength-9', name: 'Wavelength', category: 'compute', symbol: 'ä¹', type: 'ä¸‡', count: 4 },

            // å­˜å‚¨æœåŠ¡ (æ¡)
            { id: 's3-1', name: 'S3', category: 'storage', symbol: 'ä¸€', type: 'æ¡', count: 4 },
            { id: 'ebs-2', name: 'EBS', category: 'storage', symbol: 'äºŒ', type: 'æ¡', count: 4 },
            { id: 'efs-3', name: 'EFS', category: 'storage', symbol: 'ä¸‰', type: 'æ¡', count: 4 },
            { id: 'fsx-4', name: 'FSx', category: 'storage', symbol: 'å››', type: 'æ¡', count: 4 },
            { id: 'glacier-5', name: 'Glacier', category: 'storage', symbol: 'äº”', type: 'æ¡', count: 4 },
            { id: 'backup-6', name: 'Backup', category: 'storage', symbol: 'å…­', type: 'æ¡', count: 4 },
            { id: 'datasync-7', name: 'DataSync', category: 'storage', symbol: 'ä¸ƒ', type: 'æ¡', count: 4 },
            { id: 'snowball-8', name: 'Snowball', category: 'storage', symbol: 'å…«', type: 'æ¡', count: 4 },
            { id: 'snowmobile-9', name: 'Snowmobile', category: 'storage', symbol: 'ä¹', type: 'æ¡', count: 4 },

            // æ•°æ®åº“æœåŠ¡ (ç­’)
            { id: 'rds-1', name: 'RDS', category: 'database', symbol: 'ä¸€', type: 'ç­’', count: 4 },
            { id: 'dynamodb-2', name: 'DynamoDB', category: 'database', symbol: 'äºŒ', type: 'ç­’', count: 4 },
            { id: 'redshift-3', name: 'Redshift', category: 'database', symbol: 'ä¸‰', type: 'ç­’', count: 4 },
            { id: 'aurora-4', name: 'Aurora', category: 'database', symbol: 'å››', type: 'ç­’', count: 4 },
            { id: 'documentdb-5', name: 'DocumentDB', category: 'database', symbol: 'äº”', type: 'ç­’', count: 4 },
            { id: 'neptune-6', name: 'Neptune', category: 'database', symbol: 'å…­', type: 'ç­’', count: 4 },
            { id: 'timestream-7', name: 'Timestream', category: 'database', symbol: 'ä¸ƒ', type: 'ç­’', count: 4 },
            { id: 'qldb-8', name: 'QLDB', category: 'database', symbol: 'å…«', type: 'ç­’', count: 4 },
            { id: 'keyspaces-9', name: 'Keyspaces', category: 'database', symbol: 'ä¹', type: 'ç­’', count: 4 },

            // AI/MLæœåŠ¡ (å­—ç‰Œ)
            { id: 'sagemaker', name: 'SageMaker', category: 'ai-ml', symbol: 'ä¸œ', type: 'å­—', count: 4 },
            { id: 'rekognition', name: 'Rekognition', category: 'ai-ml', symbol: 'å—', type: 'å­—', count: 4 },
            { id: 'comprehend', name: 'Comprehend', category: 'ai-ml', symbol: 'è¥¿', type: 'å­—', count: 4 },
            { id: 'textract', name: 'Textract', category: 'ai-ml', symbol: 'åŒ—', type: 'å­—', count: 4 },
            { id: 'polly', name: 'Polly', category: 'ai-ml', symbol: 'ä¸­', type: 'å­—', count: 4 },
            { id: 'transcribe', name: 'Transcribe', category: 'ai-ml', symbol: 'å‘', type: 'å­—', count: 4 },
            { id: 'translate', name: 'Translate', category: 'ai-ml', symbol: 'ç™½', type: 'å­—', count: 4 }
        ];

        let gameTiles = [];
        let playerHand = [];
        let completedMelds = [];
        let selectedTiles = [];
        let score = 0;
        let round = 1;

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // åˆ›å»ºç‰Œåº“
            gameTiles = [];
            awsTiles.forEach(tile => {
                for (let i = 0; i < tile.count; i++) {
                    gameTiles.push({...tile, uniqueId: `${tile.id}-${i}`});
                }
            });
            
            // æ´—ç‰Œ
            shuffleTiles();
            
            // å‘åˆå§‹æ‰‹ç‰Œï¼ˆ13å¼ ï¼‰
            playerHand = [];
            for (let i = 0; i < 13; i++) {
                drawTile();
            }
            
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            completedMelds = [];
            selectedTiles = [];
            score = 0;
            round = 1;
            
            updateDisplay();
        }

        // æ´—ç‰Œ
        function shuffleTiles() {
            for (let i = gameTiles.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [gameTiles[i], gameTiles[j]] = [gameTiles[j], gameTiles[i]];
            }
        }

        // æ‘¸ç‰Œ
        function drawTile() {
            if (gameTiles.length > 0) {
                const tile = gameTiles.pop();
                playerHand.push(tile);
                updateDisplay();
                return tile;
            }
            return null;
        }

        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            // æ›´æ–°æ‰‹ç‰Œæ˜¾ç¤º
            const handElement = $('#player-hand');
            handElement.empty();
            
            playerHand.forEach((tile, index) => {
                const tileElement = $(`
                    <div class="mahjong-tile ${tile.category} new-tile" data-index="${index}">
                        <div class="tile-symbol">${tile.symbol}</div>
                        <div class="tile-name">${tile.name}</div>
                        <div class="tile-name">${tile.type}</div>
                    </div>
                `);
                handElement.append(tileElement);
                
                // ç§»é™¤new-tileç±»ï¼Œé¿å…é‡å¤åŠ¨ç”»
                setTimeout(() => {
                    tileElement.removeClass('new-tile');
                }, 800);
            });

            // æ›´æ–°å®Œæˆçš„ç»„åˆæ˜¾ç¤º
            const meldsElement = $('#completed-melds');
            meldsElement.empty();
            
            completedMelds.forEach((meld, index) => {
                const meldDiv = $('<div class="meld-area p-2 flex gap-1"></div>');
                meld.tiles.forEach(tile => {
                    const tileElement = $(`
                        <div class="mahjong-tile ${tile.category} meld-complete" style="transform: scale(0.8);">
                            <div class="tile-symbol">${tile.symbol}</div>
                            <div class="tile-name">${tile.name}</div>
                        </div>
                    `);
                    meldDiv.append(tileElement);
                });
                
                const scoreLabel = $(`<div class="text-white text-sm mt-1">${meld.type}: +${meld.score}åˆ†</div>`);
                const meldContainer = $('<div class="text-center"></div>');
                meldContainer.append(meldDiv).append(scoreLabel);
                meldsElement.append(meldContainer);
            });

            // æ›´æ–°çŠ¶æ€æ 
            $('#score').text(score);
            $('#remaining-tiles').text(gameTiles.length);
            $('#round').text(round);
        }

        // æ£€æŸ¥æ˜¯å¦å¯ä»¥ç»„æˆç»„åˆ
        function checkMelds() {
            if (selectedTiles.length !== 3) return false;
            
            const tiles = selectedTiles.map(index => playerHand[index]);
            
            // æ£€æŸ¥åˆ»å­ï¼ˆä¸‰å¼ ç›¸åŒï¼‰
            if (tiles[0].name === tiles[1].name && tiles[1].name === tiles[2].name) {
                return { type: 'åˆ»å­', tiles: tiles, score: 100 };
            }
            
            // æ£€æŸ¥é¡ºå­ï¼ˆåŒç±»å‹è¿ç»­ï¼‰
            if (tiles[0].type === tiles[1].type && tiles[1].type === tiles[2].type && tiles[0].type !== 'å­—') {
                const symbols = tiles.map(t => t.symbol).sort();
                const numbers = symbols.map(s => ['ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'].indexOf(s) + 1);
                if (numbers[2] - numbers[1] === 1 && numbers[1] - numbers[0] === 1) {
                    return { type: 'é¡ºå­', tiles: tiles, score: 80 };
                }
            }
            
            return false;
        }

        // æ£€æŸ¥èƒ¡ç‰Œ
        function checkWin() {
            // ç®€åŒ–çš„èƒ¡ç‰Œæ£€æŸ¥ï¼šéœ€è¦4ä¸ªç»„åˆ + 1å¯¹çœ¼
            if (completedMelds.length >= 4 && playerHand.length >= 2) {
                // æ£€æŸ¥æ˜¯å¦æœ‰å¯¹å­ä½œä¸ºçœ¼ç‰Œ
                const handCounts = {};
                playerHand.forEach(tile => {
                    handCounts[tile.name] = (handCounts[tile.name] || 0) + 1;
                });
                
                const hasPair = Object.values(handCounts).some(count => count >= 2);
                
                if (hasPair) {
                    // è®¡ç®—ç‰¹æ®Šèƒ¡ç‰Œå¥–åŠ±
                    let bonus = 0;
                    const categories = completedMelds.map(m => m.tiles[0].category);
                    
                    if (categories.every(cat => cat === 'ai-ml')) {
                        bonus = 500; // å…¨AIæœåŠ¡
                    } else if (categories.every(cat => cat === 'storage')) {
                        bonus = 300; // å…¨å­˜å‚¨æœåŠ¡
                    } else if (categories.every(cat => cat === 'compute')) {
                        bonus = 350; // å…¨è®¡ç®—æœåŠ¡
                    }
                    
                    return { win: true, bonus: bonus };
                }
            }
            
            return { win: false, bonus: 0 };
        }

        // äº‹ä»¶å¤„ç†
        $(document).ready(function() {
            // åˆå§‹åŒ–æ¸¸æˆ
            initGame();

            // ç‰Œç‚¹å‡»äº‹ä»¶
            $(document).on('click', '.mahjong-tile', function() {
                const index = parseInt($(this).data('index'));
                if (index !== undefined) {
                    if (selectedTiles.includes(index)) {
                        selectedTiles = selectedTiles.filter(i => i !== index);
                        $(this).removeClass('selected');
                    } else if (selectedTiles.length < 3) {
                        selectedTiles.push(index);
                        $(this).addClass('selected');
                        playSound('select'); // æ’­æ”¾é€‰æ‹©éŸ³æ•ˆ
                    }
                    
                    // å¦‚æœé€‰æ‹©äº†3å¼ ç‰Œï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»„åˆ
                    if (selectedTiles.length === 3) {
                        const meld = checkMelds();
                        if (meld) {
                            setTimeout(() => {
                                if (confirm(`å‘ç°${meld.type}ï¼è·å¾—${meld.score}åˆ†ï¼Œæ˜¯å¦ç¡®è®¤ç»„åˆï¼Ÿ`)) {
                                    // æ’­æ”¾ç»„åˆéŸ³æ•ˆ
                                    playSound('meld');
                                    
                                    // æ˜¾ç¤ºæµ®åŠ¨åˆ†æ•°
                                    const rect = $(this)[0].getBoundingClientRect();
                                    showFloatingScore(meld.score, rect.left + rect.width/2, rect.top);
                                    
                                    // æ·»åŠ åˆ°å®Œæˆçš„ç»„åˆ
                                    completedMelds.push(meld);
                                    score += meld.score;
                                    
                                    // ä»æ‰‹ç‰Œä¸­ç§»é™¤
                                    selectedTiles.sort((a, b) => b - a); // ä»å¤§åˆ°å°æ’åº
                                    selectedTiles.forEach(index => {
                                        playerHand.splice(index, 1);
                                    });
                                    
                                    selectedTiles = [];
                                    updateDisplay();
                                }
                            }, 100);
                        }
                    }
                }
            });

            // æ‘¸ç‰ŒæŒ‰é’®
            $('#draw-tile').click(function() {
                if (playerHand.length < 14) {
                    const tile = drawTile();
                    if (tile) {
                        playSound('draw'); // æ’­æ”¾æ‘¸ç‰ŒéŸ³æ•ˆ
                        $('#game-result').html(`
                            <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded">
                                æ‘¸åˆ°äº†ï¼š${tile.name} (${tile.type}${tile.symbol})
                            </div>
                        `);
                    } else {
                        $('#game-result').html(`
                            <div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded">
                                ç‰Œåº“å·²ç©ºï¼
                            </div>
                        `);
                    }
                } else {
                    $('#game-result').html(`
                        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                            æ‰‹ç‰Œå·²æ»¡ï¼è¯·å…ˆç»„åˆæˆ–æ‰“å‡ºä¸€äº›ç‰Œã€‚
                        </div>
                    `);
                }
            });

            // æ£€æŸ¥èƒ¡ç‰ŒæŒ‰é’®
            $('#check-win').click(function() {
                const winResult = checkWin();
                if (winResult.win) {
                    playSound('win'); // æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ
                    const totalScore = score + winResult.bonus;
                    $('#game-result').html(`
                        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded text-center win-celebration">
                            <h3 class="text-2xl font-bold">ğŸ‰ æ­å–œèƒ¡ç‰Œï¼ğŸ‰</h3>
                            <p>åŸºç¡€åˆ†æ•°ï¼š${score}åˆ†</p>
                            <p>ç‰¹æ®Šå¥–åŠ±ï¼š${winResult.bonus}åˆ†</p>
                            <p class="text-xl font-bold">æ€»åˆ†ï¼š${totalScore}åˆ†</p>
                        </div>
                    `);
                    score = totalScore;
                    updateDisplay();
                } else {
                    $('#game-result').html(`
                        <div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded">
                            è¿˜æ²¡æœ‰èƒ¡ç‰Œï¼éœ€è¦4ä¸ªç»„åˆ + 1å¯¹çœ¼ç‰Œã€‚å½“å‰å·²å®Œæˆ${completedMelds.length}ä¸ªç»„åˆã€‚
                        </div>
                    `);
                }
            });

            // é‡æ–°å¼€å§‹æŒ‰é’®
            $('#reset-game').click(function() {
                if (confirm('ç¡®å®šè¦é‡æ–°å¼€å§‹æ¸¸æˆå—ï¼Ÿ')) {
                    initGame();
                    $('#game-result').empty();
                }
            });
        });
    </script>
</body>
</html>