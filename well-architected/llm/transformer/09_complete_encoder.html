<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´Transformer Encoderè¯¦è§£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%);
            color: #333;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #f57f17;
            margin-bottom: 15px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1em;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 1.8em;
            color: #f57f17;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #fdd835;
        }
        
        .content-text {
            color: #555;
            font-size: 1.05em;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        
        .highlight {
            color: #f57f17;
            font-weight: bold;
            background: #fff9c4;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        /* å®Œæ•´æ¶æ„å›¾ */
        .encoder-architecture {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin: 40px 0;
            padding: 40px;
            background: linear-gradient(135deg, #fff9c4, #fff59d);
            border-radius: 15px;
        }
        
        .arch-layer {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-left: 6px solid #ffb300;
            transition: all 0.3s;
        }
        
        .arch-layer:hover {
            transform: translateX(10px);
            box-shadow: 0 8px 25px rgba(245, 127, 23, 0.3);
        }
        
        .layer-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #f57f17;
            margin-bottom: 10px;
        }
        
        .layer-desc {
            color: #666;
            line-height: 1.6;
        }
        
        .layer-formula {
            background: #fffde7;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin-top: 10px;
            color: #f57f17;
            font-weight: bold;
        }
        
        /* æ•°æ®æµåŠ¨ */
        .data-flow {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 30px 0;
            padding: 30px;
            background: #f5f5f5;
            border-radius: 10px;
        }
        
        .flow-item {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .flow-shape {
            background: linear-gradient(135deg, #ffd54f, #ffb300);
            color: #333;
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: bold;
            min-width: 200px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .flow-arrow {
            font-size: 2em;
            color: #f57f17;
        }
        
        .flow-info {
            color: #666;
            font-size: 0.95em;
        }
        
        /* æ¨¡å—ç»„æˆ */
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .module-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .module-card:hover {
            border-color: #f57f17;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(245, 127, 23, 0.3);
        }
        
        .module-icon {
            font-size: 3em;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .module-title {
            color: #f57f17;
            font-weight: bold;
            font-size: 1.2em;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .module-desc {
            color: #666;
            text-align: center;
            line-height: 1.6;
            font-size: 0.95em;
        }
        
        /* å¯¹æ¯”è¡¨æ ¼ */
        .comparison-table {
            width: 100%;
            margin: 30px 0;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #fdd835, #f57f17);
            color: #333;
            padding: 15px;
            font-weight: bold;
            text-align: left;
        }
        
        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            color: #555;
        }
        
        .comparison-table tr:hover {
            background: #fff9c4;
        }
        
        /* æç¤ºæ¡† */
        .tip-box {
            background: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
        }
        
        .tip-title {
            color: #1565c0;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        
        .tip-content {
            color: #555;
            line-height: 1.8;
        }
        
        /* ä»£ç å— */
        .code-block {
            background: #263238;
            color: #aed581;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 25px 0;
            overflow-x: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ï¸ å®Œæ•´Transformer Encoder</h1>
        <p class="subtitle">ç»„è£…æ‰€æœ‰æ¨¡å— - ä»è¾“å…¥åˆ°è¾“å‡ºçš„å®Œæ•´æµç¨‹</p>
        
        <!-- 1. æ•´ä½“æ¶æ„ -->
        <div class="section">
            <h2 class="section-title">ä¸€ã€Encoderå®Œæ•´æ¶æ„</h2>
            <p class="content-text">
                ä¸€ä¸ªå®Œæ•´çš„Encoderå±‚åŒ…å«<span class="highlight">ä¸¤ä¸ªå­å±‚</span>ï¼Œæ¯ä¸ªå­å±‚åéƒ½æœ‰Add&Normï¼š
            </p>
            
            <div class="encoder-architecture">
                <div class="arch-layer" style="border-color: #42a5f5;">
                    <div class="layer-title">ğŸ“¥ è¾“å…¥å¤„ç†</div>
                    <div class="layer-desc">
                        è¯åµŒå…¥ï¼ˆToken Embeddingï¼‰+ ä½ç½®ç¼–ç ï¼ˆPositional Encodingï¼‰
                    </div>
                    <div class="layer-formula">
                        Input = Embedding(tokens) + PositionalEncoding
                    </div>
                </div>
                
                <div style="text-align: center; font-size: 2em; color: #f57f17;">â†“</div>
                
                <div class="arch-layer" style="border-color: #ab47bc;">
                    <div class="layer-title">ğŸ”€ å­å±‚1ï¼šå¤šå¤´è‡ªæ³¨æ„åŠ›</div>
                    <div class="layer-desc">
                        8ä¸ªæ³¨æ„åŠ›å¤´å¹¶è¡Œè®¡ç®—ï¼Œæ•æ‰è¯ä¸è¯ä¹‹é—´çš„å…³ç³»
                    </div>
                    <div class="layer-formula">
                        X = LayerNorm(X + MultiHeadAttention(X, X, X))
                    </div>
                </div>
                
                <div style="text-align: center; font-size: 2em; color: #f57f17;">â†“</div>
                
                <div class="arch-layer" style="border-color: #66bb6a;">
                    <div class="layer-title">ğŸ”„ å­å±‚2ï¼šå‰é¦ˆç¥ç»ç½‘ç»œ</div>
                    <div class="layer-desc">
                        ä¸¤å±‚å…¨è¿æ¥ç½‘ç»œï¼Œç»´åº¦å…ˆæ‰©å±•4å€å†å‹ç¼©å›æ¥
                    </div>
                    <div class="layer-formula">
                        X = LayerNorm(X + FeedForward(X))
                    </div>
                </div>
                
                <div style="text-align: center; font-size: 2em; color: #f57f17;">â†“</div>
                
                <div class="arch-layer" style="border-color: #ff9800;">
                    <div class="layer-title">ğŸ“¤ è¾“å‡º</div>
                    <div class="layer-desc">
                        èåˆäº†ä¸Šä¸‹æ–‡ä¿¡æ¯çš„å‘é‡è¡¨ç¤ºï¼Œä¼ é€’ç»™ä¸‹ä¸€å±‚æˆ–ç”¨äºé¢„æµ‹
                    </div>
                    <div class="layer-formula">
                        Output (seq_len, d_model)
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 2. æ•°æ®æµåŠ¨ -->
        <div class="section">
            <h2 class="section-title">äºŒã€æ•°æ®ç»´åº¦å˜åŒ–å…¨æµç¨‹</h2>
            
            <div class="data-flow">
                <div class="flow-item">
                    <div class="flow-shape">è¾“å…¥Token IDs<br>(batch, seq_len)</div>
                    <div class="flow-arrow">â†’</div>
                    <div class="flow-info">ä¾‹ï¼š(32, 10)<br>32ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ª10ä¸ªè¯</div>
                </div>
                
                <div class="flow-item">
                    <div class="flow-shape">è¯åµŒå…¥<br>(batch, seq_len, 512)</div>
                    <div class="flow-arrow">â†’</div>
                    <div class="flow-info">é€šè¿‡EmbeddingçŸ©é˜µ</div>
                </div>
                
                <div class="flow-item">
                    <div class="flow-shape">ä½ç½®ç¼–ç <br>(batch, seq_len, 512)</div>
                    <div class="flow-arrow">â†’</div>
                    <div class="flow-info">ç›¸åŠ èå…¥ä½ç½®ä¿¡æ¯</div>
                </div>
                
                <div class="flow-item">
                    <div class="flow-shape">å¤šå¤´æ³¨æ„åŠ›<br>(batch, seq_len, 512)</div>
                    <div class="flow-arrow">â†’</div>
                    <div class="flow-info">å†…éƒ¨åˆ†ä¸º8ä¸ªå¤´ï¼Œæ¯å¤´64ç»´</div>
                </div>
                
                <div class="flow-item">
                    <div class="flow-shape">Add & Norm<br>(batch, seq_len, 512)</div>
                    <div class="flow-arrow">â†’</div>
                    <div class="flow-info">æ®‹å·®è¿æ¥+å±‚å½’ä¸€åŒ–</div>
                </div>
                
                <div class="flow-item">
                    <div class="flow-shape">å‰é¦ˆç½‘ç»œ<br>(batch, seq_len, 512)</div>
                    <div class="flow-arrow">â†’</div>
                    <div class="flow-info">512â†’2048â†’512</div>
                </div>
                
                <div class="flow-item">
                    <div class="flow-shape">Add & Norm<br>(batch, seq_len, 512)</div>
                    <div class="flow-arrow">â†’</div>
                    <div class="flow-info">ç¬¬äºŒæ¬¡æ®‹å·®+å½’ä¸€åŒ–</div>
                </div>
                
                <div class="flow-item">
                    <div class="flow-shape" style="background: linear-gradient(135deg, #ff9800, #f57f17);">
                        Encoderè¾“å‡º<br>(batch, seq_len, 512)
                    </div>
                    <div class="flow-arrow">âœ“</div>
                    <div class="flow-info">å®Œæˆä¸€å±‚ç¼–ç </div>
                </div>
            </div>
            
            <p class="content-text" style="text-align: center; color: #f57f17; font-weight: bold; margin-top: 20px;">
                âš ï¸ ç»´åº¦å§‹ç»ˆä¿æŒä¸å˜ï¼š(batch_size, seq_len, d_model)
            </p>
        </div>
        
        <!-- 3. æ ¸å¿ƒæ¨¡å—å›é¡¾ -->
        <div class="section">
            <h2 class="section-title">ä¸‰ã€æ ¸å¿ƒæ¨¡å—è¯¦è§£</h2>
            
            <div class="module-grid">
                <div class="module-card">
                    <div class="module-icon">ğŸ“š</div>
                    <div class="module-title">Token Embedding</div>
                    <div class="module-desc">
                        å°†è¯IDè½¬ä¸º512ç»´å‘é‡<br>
                        å‚æ•°é‡ï¼švocab_size Ã— 512
                    </div>
                </div>
                
                <div class="module-card">
                    <div class="module-icon">ğŸ“</div>
                    <div class="module-title">ä½ç½®ç¼–ç </div>
                    <div class="module-desc">
                        æ­£å¼¦ä½™å¼¦å‡½æ•°ç”Ÿæˆ<br>
                        æ— éœ€è®­ç»ƒå‚æ•°
                    </div>
                </div>
                
                <div class="module-card">
                    <div class="module-icon">ğŸ”€</div>
                    <div class="module-title">å¤šå¤´æ³¨æ„åŠ›</div>
                    <div class="module-desc">
                        8ä¸ªå¤´å¹¶è¡Œï¼Œæ¯å¤´64ç»´<br>
                        å‚æ•°é‡ï¼šçº¦105ä¸‡
                    </div>
                </div>
                
                <div class="module-card">
                    <div class="module-icon">ğŸ”„</div>
                    <div class="module-title">å‰é¦ˆç½‘ç»œ</div>
                    <div class="module-desc">
                        512â†’2048â†’512<br>
                        å‚æ•°é‡ï¼šçº¦210ä¸‡
                    </div>
                </div>
                
                <div class="module-card">
                    <div class="module-icon">â•</div>
                    <div class="module-title">æ®‹å·®è¿æ¥</div>
                    <div class="module-desc">
                        X + Sublayer(X)<br>
                        è§£å†³æ¢¯åº¦æ¶ˆå¤±
                    </div>
                </div>
                
                <div class="module-card">
                    <div class="module-icon">ğŸ“Š</div>
                    <div class="module-title">å±‚å½’ä¸€åŒ–</div>
                    <div class="module-desc">
                        å‡å€¼0ï¼Œæ–¹å·®1<br>
                        å‚æ•°é‡ï¼š2 Ã— 512
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 4. å‚æ•°é‡ç»Ÿè®¡ -->
        <div class="section">
            <h2 class="section-title">å››ã€å•å±‚Encoderå‚æ•°é‡</h2>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>æ¨¡å—</th>
                        <th>å­ç»„ä»¶</th>
                        <th>å‚æ•°é‡</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td rowspan="4"><strong>å¤šå¤´æ³¨æ„åŠ›</strong></td>
                        <td>W_Q</td>
                        <td>512 Ã— 512 = 262,144</td>
                    </tr>
                    <tr>
                        <td>W_K</td>
                        <td>512 Ã— 512 = 262,144</td>
                    </tr>
                    <tr>
                        <td>W_V</td>
                        <td>512 Ã— 512 = 262,144</td>
                    </tr>
                    <tr>
                        <td>W_O</td>
                        <td>512 Ã— 512 = 262,144</td>
                    </tr>
                    <tr style="background: #fff9c4;">
                        <td colspan="2"><strong>å¤šå¤´æ³¨æ„åŠ›å°è®¡</strong></td>
                        <td><strong>1,048,576</strong></td>
                    </tr>
                    <tr>
                        <td rowspan="2"><strong>å‰é¦ˆç½‘ç»œ</strong></td>
                        <td>ç¬¬ä¸€å±‚</td>
                        <td>512 Ã— 2048 = 1,048,576</td>
                    </tr>
                    <tr>
                        <td>ç¬¬äºŒå±‚</td>
                        <td>2048 Ã— 512 = 1,048,576</td>
                    </tr>
                    <tr style="background: #fff9c4;">
                        <td colspan="2"><strong>å‰é¦ˆç½‘ç»œå°è®¡</strong></td>
                        <td><strong>2,097,152</strong></td>
                    </tr>
                    <tr>
                        <td rowspan="2"><strong>å±‚å½’ä¸€åŒ–</strong></td>
                        <td>ç¬¬1æ¬¡ï¼ˆæ³¨æ„åŠ›åï¼‰</td>
                        <td>2 Ã— 512 = 1,024</td>
                    </tr>
                    <tr>
                        <td>ç¬¬2æ¬¡ï¼ˆFFNåï¼‰</td>
                        <td>2 Ã— 512 = 1,024</td>
                    </tr>
                    <tr style="background: #ffd54f;">
                        <td colspan="2"><strong>å•å±‚Encoderæ€»è®¡</strong></td>
                        <td><strong>3,147,776 â‰ˆ 315ä¸‡</strong></td>
                    </tr>
                    <tr style="background: #ff9800; color: white;">
                        <td colspan="2"><strong>6å±‚Encoderæ€»è®¡</strong></td>
                        <td><strong>18,886,656 â‰ˆ 1889ä¸‡</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- 5. å †å å¤šå±‚ -->
        <div class="section">
            <h2 class="section-title">äº”ã€å †å 6å±‚Encoder</h2>
            
            <div class="tip-box">
                <div class="tip-title">ğŸ—ï¸ ä¸ºä»€ä¹ˆå †å å¤šå±‚</div>
                <div class="tip-content">
                    <strong>é€å±‚æŠ½è±¡ï¼š</strong><br>
                    â€¢ <strong>ç¬¬1-2å±‚ï¼š</strong>å­¦ä¹ å±€éƒ¨æ¨¡å¼ï¼ˆè¯æ€§ã€çŸ­è¯­ï¼‰<br>
                    â€¢ <strong>ç¬¬3-4å±‚ï¼š</strong>å­¦ä¹ å¥æ³•ç»“æ„ï¼ˆä¸»è°“å®¾ã€ä»å¥ï¼‰<br>
                    â€¢ <strong>ç¬¬5-6å±‚ï¼š</strong>å­¦ä¹ è¯­ä¹‰å…³ç³»ï¼ˆå…±æŒ‡ã€æ¨ç†ï¼‰<br>
                    <br>
                    <strong>æ ‡å‡†é…ç½®ï¼š</strong><br>
                    â€¢ BERT-Base: 12å±‚Encoder<br>
                    â€¢ GPT-3: 96å±‚<br>
                    â€¢ åŸå§‹Transformer: 6å±‚Encoder + 6å±‚Decoder
                </div>
            </div>
            
            <div style="background: linear-gradient(135deg, #fff9c4, #fff59d); padding: 30px; border-radius: 15px; margin: 30px 0;">
                <div style="display: flex; flex-direction: column; gap: 15px; align-items: center;">
                    <div style="background: white; padding: 20px 40px; border-radius: 10px; font-weight: bold; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        Encoder Layer 6
                    </div>
                    <div style="font-size: 2em; color: #f57f17;">â†‘</div>
                    <div style="background: white; padding: 20px 40px; border-radius: 10px; font-weight: bold; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        Encoder Layer 5
                    </div>
                    <div style="font-size: 2em; color: #f57f17;">â†‘</div>
                    <div style="background: white; padding: 20px 40px; border-radius: 10px; font-weight: bold; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        Encoder Layer 4
                    </div>
                    <div style="font-size: 1.5em; color: #f57f17;">â‹®</div>
                    <div style="background: white; padding: 20px 40px; border-radius: 10px; font-weight: bold; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        Encoder Layer 1
                    </div>
                    <div style="font-size: 2em; color: #f57f17;">â†‘</div>
                    <div style="background: linear-gradient(135deg, #42a5f5, #1e88e5); color: white; padding: 20px 40px; border-radius: 10px; font-weight: bold; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        è¾“å…¥ï¼ˆEmbedding + Positionï¼‰
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 6. å®Œæ•´ä»£ç  -->
        <div class="section">
            <h2 class="section-title">å…­ã€å®Œæ•´PyTorchå®ç°</h2>
            
            <div class="code-block">
<span style="color: #82b1ff;">import</span> torch
<span style="color: #82b1ff;">import</span> torch.nn <span style="color: #82b1ff;">as</span> nn

<span style="color: #82b1ff;">class</span> <span style="color: #ffb74d;">EncoderLayer</span>(nn.Module):
    <span style="color: #90a4ae;">"""å•å±‚Transformer Encoder"""</span>
    <span style="color: #82b1ff;">def</span> <span style="color: #ffb74d;">__init__</span>(self, d_model=512, num_heads=8, d_ff=2048, dropout=0.1):
        super().__init__()
        
        <span style="color: #90a4ae;"># å¤šå¤´æ³¨æ„åŠ›</span>
        self.multi_head_attention = MultiHeadAttention(d_model, num_heads)
        
        <span style="color: #90a4ae;"># å‰é¦ˆç½‘ç»œ</span>
        self.feed_forward = nn.Sequential(
            nn.Linear(d_model, d_ff),
            nn.ReLU(),
            nn.Dropout(dropout),
            nn.Linear(d_ff, d_model)
        )
        
        <span style="color: #90a4ae;"># ä¸¤ä¸ªå±‚å½’ä¸€åŒ–</span>
        self.norm1 = nn.LayerNorm(d_model)
        self.norm2 = nn.LayerNorm(d_model)
        
        <span style="color: #90a4ae;"># Dropout</span>
        self.dropout = nn.Dropout(dropout)
    
    <span style="color: #82b1ff;">def</span> <span style="color: #ffb74d;">forward</span>(self, x):
        <span style="color: #90a4ae;"># å­å±‚1ï¼šå¤šå¤´æ³¨æ„åŠ› + Add & Norm</span>
        attn_output = self.multi_head_attention(x, x, x)
        x = self.norm1(x + self.dropout(attn_output))
        
        <span style="color: #90a4ae;"># å­å±‚2ï¼šå‰é¦ˆç½‘ç»œ + Add & Norm</span>
        ff_output = self.feed_forward(x)
        x = self.norm2(x + self.dropout(ff_output))
        
        <span style="color: #82b1ff;">return</span> x

<span style="color: #82b1ff;">class</span> <span style="color: #ffb74d;">TransformerEncoder</span>(nn.Module):
    <span style="color: #90a4ae;">"""å®Œæ•´çš„Transformer Encoderï¼ˆå †å Nå±‚ï¼‰"""</span>
    <span style="color: #82b1ff;">def</span> <span style="color: #ffb74d;">__init__</span>(self, vocab_size, d_model=512, num_layers=6, 
                 num_heads=8, d_ff=2048, max_len=5000, dropout=0.1):
        super().__init__()
        
        <span style="color: #90a4ae;"># è¯åµŒå…¥</span>
        self.embedding = nn.Embedding(vocab_size, d_model)
        
        <span style="color: #90a4ae;"># ä½ç½®ç¼–ç </span>
        self.pos_encoding = PositionalEncoding(d_model, max_len)
        
        <span style="color: #90a4ae;"># å †å Nå±‚Encoder</span>
        self.layers = nn.ModuleList([
            EncoderLayer(d_model, num_heads, d_ff, dropout)
            <span style="color: #82b1ff;">for</span> _ <span style="color: #82b1ff;">in</span> range(num_layers)
        ])
        
        self.dropout = nn.Dropout(dropout)
    
    <span style="color: #82b1ff;">def</span> <span style="color: #ffb74d;">forward</span>(self, x):
        <span style="color: #90a4ae;"># x shape: (batch_size, seq_len)</span>
        
        <span style="color: #90a4ae;"># 1. è¯åµŒå…¥</span>
        x = self.embedding(x)  <span style="color: #90a4ae;"># (batch, seq_len, d_model)</span>
        
        <span style="color: #90a4ae;"># 2. åŠ ä¸Šä½ç½®ç¼–ç </span>
        x = self.pos_encoding(x)
        x = self.dropout(x)
        
        <span style="color: #90a4ae;"># 3. é€å±‚é€šè¿‡Encoder</span>
        <span style="color: #82b1ff;">for</span> layer <span style="color: #82b1ff;">in</span> self.layers:
            x = layer(x)
        
        <span style="color: #82b1ff;">return</span> x

<span style="color: #90a4ae;"># ä½¿ç”¨ç¤ºä¾‹</span>
vocab_size = 30000
batch_size = 32
seq_len = 10

<span style="color: #90a4ae;"># åˆ›å»ºæ¨¡å‹</span>
encoder = TransformerEncoder(
    vocab_size=vocab_size,
    d_model=512,
    num_layers=6,
    num_heads=8,
    d_ff=2048
)

<span style="color: #90a4ae;"># è¾“å…¥token IDs</span>
input_ids = torch.randint(0, vocab_size, (batch_size, seq_len))

<span style="color: #90a4ae;"># å‰å‘ä¼ æ’­</span>
output = encoder(input_ids)

<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"è¾“å…¥: {input_ids.shape}"</span>)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"è¾“å‡º: {output.shape}"</span>)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"å‚æ•°é‡: {sum(p.numel() for p in encoder.parameters()):,}"</span>)
            </div>
        </div>
        
        <!-- æ€»ç»“ -->
        <div style="background: linear-gradient(135deg, #fff9c4, #fff59d); padding: 30px; border-radius: 15px; margin-top: 40px;">
            <h3 style="color: #f57f17; text-align: center; margin-bottom: 20px; font-size: 1.5em;">
                âœ¨ æ ¸å¿ƒè¦ç‚¹æ€»ç»“
            </h3>
            <div style="color: #555; line-height: 2; font-size: 1.05em;">
                âœ“ Encoderç”±è¾“å…¥å¤„ç†+å¤šå¤´æ³¨æ„åŠ›+å‰é¦ˆç½‘ç»œç»„æˆï¼Œæ¯ä¸ªå­å±‚åæœ‰Add&Norm<br>
                âœ“ æ•°æ®ç»´åº¦å§‹ç»ˆä¿æŒ(batch, seq_len, d_model)ä¸å˜<br>
                âœ“ å•å±‚çº¦315ä¸‡å‚æ•°ï¼Œ6å±‚çº¦1889ä¸‡å‚æ•°<br>
                âœ“ é€šè¿‡å †å å¤šå±‚å®ç°é€å±‚æŠ½è±¡ï¼Œä»è¯æ³•åˆ°å¥æ³•åˆ°è¯­ä¹‰<br>
                âœ“ è¿™å°±æ˜¯Transformer Encoderçš„å®Œæ•´ç»“æ„ï¼ŒBERTç­‰æ¨¡å‹çš„åŸºç¡€
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; color: #999; font-size: 0.9em;">
            <p>Â© 2025 å®Œæ•´Transformer Encoderè¯¦è§£ - Transformerç³»åˆ—æ•™ç¨‹</p>
        </div>
    </div>
</body>
</html>