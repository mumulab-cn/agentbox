<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Softmaxå½’ä¸€åŒ–è¯¦è§£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
            color: #333;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #00838f;
            margin-bottom: 15px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1em;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 1.8em;
            color: #00838f;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #80deea;
        }
        
        .content-text {
            color: #555;
            font-size: 1.05em;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        
        .highlight {
            color: #00838f;
            font-weight: bold;
            background: #e0f7fa;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        /* Softmaxè½¬æ¢å¯è§†åŒ– */
        .softmax-transform {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 40px 0;
            padding: 30px;
            background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
            border-radius: 15px;
            flex-wrap: wrap;
            gap: 30px;
        }
        
        .transform-stage {
            text-align: center;
        }
        
        .stage-label {
            color: #00838f;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
        }
        
        .value-box {
            background: white;
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            min-width: 150px;
        }
        
        .value-item {
            margin: 10px 0;
            font-size: 1.1em;
            font-family: 'Courier New', monospace;
        }
        
        .value-before {
            color: #e53935;
            font-weight: bold;
        }
        
        .value-after {
            color: #43a047;
            font-weight: bold;
        }
        
        .arrow-big {
            font-size: 3em;
            color: #00838f;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        /* æ¦‚ç‡åˆ†å¸ƒå¯è§†åŒ– */
        .probability-bars {
            margin: 30px 0;
            padding: 25px;
            background: #f5f5f5;
            border-radius: 10px;
        }
        
        .bar-title {
            color: #00838f;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2em;
        }
        
        .bar-row {
            display: flex;
            align-items: center;
            margin: 15px 0;
            gap: 15px;
        }
        
        .bar-label {
            width: 80px;
            font-weight: bold;
            color: #555;
        }
        
        .bar-container {
            flex: 1;
            height: 40px;
            background: #e0e0e0;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #00acc1, #00838f);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            animation: barGrow 1.5s ease-out;
        }
        
        @keyframes barGrow {
            from { width: 0; }
        }
        
        .bar-value {
            width: 60px;
            text-align: right;
            font-family: 'Courier New', monospace;
            color: #00838f;
            font-weight: bold;
        }
        
        /* å…¬å¼æ¡† */
        .formula-box {
            background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
            border-left: 5px solid #00838f;
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
        }
        
        .formula {
            font-size: 1.4em;
            color: #00838f;
            text-align: center;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            font-weight: bold;
        }
        
        /* è®¡ç®—æ­¥éª¤ */
        .calculation-demo {
            background: #fff3e0;
            border: 3px solid #ffb74d;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .calc-header {
            color: #f57c00;
            font-size: 1.4em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .calc-step {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #ffb74d;
        }
        
        .step-title {
            color: #f57c00;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }
        
        .step-detail {
            color: #555;
            line-height: 1.8;
        }
        
        /* ç‰¹æ€§å±•ç¤º */
        .properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .property-card {
            background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .property-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 131, 143, 0.3);
        }
        
        .property-icon {
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .property-title {
            color: #00838f;
            font-weight: bold;
            font-size: 1.2em;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .property-desc {
            color: #555;
            text-align: center;
            line-height: 1.6;
        }
        
        /* å¯¹æ¯”è¡¨æ ¼ */
        .comparison-table {
            width: 100%;
            margin: 30px 0;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #00acc1, #00838f);
            color: white;
            padding: 15px;
            font-weight: bold;
            text-align: left;
        }
        
        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            color: #555;
        }
        
        .comparison-table tr:hover {
            background: #e0f7fa;
        }
        
        /* æç¤ºæ¡† */
        .tip-box {
            background: #e8f5e9;
            border-left: 5px solid #66bb6a;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
        }
        
        .tip-title {
            color: #2e7d32;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        
        .tip-content {
            color: #555;
            line-height: 1.8;
        }
        
        /* ä»£ç å— */
        .code-block {
            background: #263238;
            color: #aed581;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 25px 0;
            overflow-x: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .softmax-transform {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š Softmaxå½’ä¸€åŒ–è¯¦è§£</h1>
        <p class="subtitle">å°†æ³¨æ„åŠ›åˆ†æ•°è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒ</p>
        
        <!-- 1. åŸºæœ¬æ¦‚å¿µ -->
        <div class="section">
            <h2 class="section-title">ä¸€ã€ä»€ä¹ˆæ˜¯Softmax</h2>
            <p class="content-text">
                Softmaxå‡½æ•°å°†<span class="highlight">ä»»æ„å®æ•°</span>è½¬æ¢ä¸º<span class="highlight">æ¦‚ç‡åˆ†å¸ƒ</span>ï¼Œ
                ä¿è¯æ‰€æœ‰è¾“å‡ºå€¼åœ¨0åˆ°1ä¹‹é—´ï¼Œä¸”æ€»å’Œä¸º1ã€‚
            </p>
            
            <div class="softmax-transform">
                <div class="transform-stage">
                    <div class="stage-label">åŸå§‹åˆ†æ•°</div>
                    <div class="value-box">
                        <div class="value-item value-before">[2.5, 1.8, 3.2, 0.9]</div>
                    </div>
                    <div style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        å¯ä»¥æ˜¯ä»»æ„å€¼
                    </div>
                </div>
                
                <div class="arrow-big">â†’</div>
                
                <div class="transform-stage">
                    <div class="stage-label">Softmaxå</div>
                    <div class="value-box">
                        <div class="value-item value-after">[0.29, 0.14, 0.56, 0.06]</div>
                    </div>
                    <div style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        æ€»å’Œ=1ï¼Œè¡¨ç¤ºæ¦‚ç‡
                    </div>
                </div>
            </div>
            
            <div class="tip-box">
                <div class="tip-title">ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦Softmax</div>
                <div class="tip-content">
                    â€¢ <strong>å½’ä¸€åŒ–ï¼š</strong>å°†åˆ†æ•°è½¬ä¸º0-1ä¹‹é—´çš„æ¦‚ç‡<br>
                    â€¢ <strong>å¯è§£é‡Šæ€§ï¼š</strong>æ¦‚ç‡æ›´ç›´è§‚ï¼ˆ"æœ‰56%çš„æ³¨æ„åŠ›åœ¨è¿™ä¸ªè¯ä¸Š"ï¼‰<br>
                    â€¢ <strong>æ•°å€¼ç¨³å®šï¼š</strong>é€šè¿‡æŒ‡æ•°å‡½æ•°æ”¾å¤§å·®å¼‚ï¼Œå¼ºåŒ–é‡è¦ä¿¡æ¯<br>
                    â€¢ <strong>æ¢¯åº¦å‹å¥½ï¼š</strong>æ±‚å¯¼ç®€å•ï¼Œåˆ©äºåå‘ä¼ æ’­
                </div>
            </div>
        </div>
        
        <!-- 2. Softmaxå…¬å¼ -->
        <div class="section">
            <h2 class="section-title">äºŒã€Softmaxè®¡ç®—å…¬å¼</h2>
            
            <div class="formula-box">
                <div class="formula">Softmax(x_i) = exp(x_i) / Î£ exp(x_j)</div>
                <p style="color: #666; text-align: center; margin-top: 20px;">
                    â€¢ x_i: ç¬¬iä¸ªåˆ†æ•°<br>
                    â€¢ exp(x_i): eçš„x_iæ¬¡æ–¹<br>
                    â€¢ Î£ exp(x_j): æ‰€æœ‰åˆ†æ•°æŒ‡æ•°çš„æ€»å’Œ
                </p>
            </div>
            
            <p class="content-text">
                <strong>æ ¸å¿ƒæ­¥éª¤ï¼š</strong><br>
                1. å¯¹æ¯ä¸ªåˆ†æ•°å–æŒ‡æ•°ï¼ˆexpï¼‰<br>
                2. è®¡ç®—æ‰€æœ‰æŒ‡æ•°å€¼çš„å’Œ<br>
                3. æ¯ä¸ªæŒ‡æ•°å€¼é™¤ä»¥æ€»å’Œ
            </p>
        </div>
        
        <!-- 3. è¯¦ç»†è®¡ç®—ç¤ºä¾‹ -->
        <div class="section">
            <h2 class="section-title">ä¸‰ã€å®Œæ•´è®¡ç®—ç¤ºä¾‹</h2>
            
            <div class="calculation-demo">
                <div class="calc-header">ğŸ§® è®¡ç®—"æˆ‘"å¯¹å…¶ä»–è¯çš„æ³¨æ„åŠ›æƒé‡</div>
                
                <div class="calc-step">
                    <div class="step-title">è¾“å…¥ï¼šæ³¨æ„åŠ›åˆ†æ•°</div>
                    <div class="step-detail">
                        åŸå§‹åˆ†æ•° = [8.5, 3.2, 1.8, 2.1]<br>
                        å¯¹åº”è¯ï¼š["æˆ‘", "çˆ±", "å­¦ä¹ ", "AI"]
                    </div>
                </div>
                
                <div class="calc-step">
                    <div class="step-title">ç¬¬1æ­¥ï¼šè®¡ç®—exp(x)</div>
                    <div class="step-detail">
                        exp(8.5) = 4914.77<br>
                        exp(3.2) = 24.53<br>
                        exp(1.8) = 6.05<br>
                        exp(2.1) = 8.17
                    </div>
                </div>
                
                <div class="calc-step">
                    <div class="step-title">ç¬¬2æ­¥ï¼šè®¡ç®—æ€»å’ŒÎ£</div>
                    <div class="step-detail">
                        æ€»å’Œ = 4914.77 + 24.53 + 6.05 + 8.17<br>
                        = <strong style="color: #f57c00;">4953.52</strong>
                    </div>
                </div>
                
                <div class="calc-step">
                    <div class="step-title">ç¬¬3æ­¥ï¼šå½’ä¸€åŒ–</div>
                    <div class="step-detail">
                        å¯¹"æˆ‘": 4914.77 / 4953.52 = <strong style="color: #43a047;">0.992</strong><br>
                        å¯¹"çˆ±": 24.53 / 4953.52 = <strong style="color: #43a047;">0.005</strong><br>
                        å¯¹"å­¦ä¹ ": 6.05 / 4953.52 = <strong style="color: #43a047;">0.001</strong><br>
                        å¯¹"AI": 8.17 / 4953.52 = <strong style="color: #43a047;">0.002</strong>
                    </div>
                </div>
                
                <div class="calc-step">
                    <div class="step-title">éªŒè¯ï¼šæ€»å’Œ=1</div>
                    <div class="step-detail">
                        0.992 + 0.005 + 0.001 + 0.002 = <strong style="color: #43a047;">1.000 âœ“</strong>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 4. æ¦‚ç‡åˆ†å¸ƒå¯è§†åŒ– -->
        <div class="section">
            <h2 class="section-title">å››ã€æ³¨æ„åŠ›æƒé‡åˆ†å¸ƒ</h2>
            <p class="content-text">
                Softmaxåçš„ç»“æœè¡¨ç¤ºæ¯ä¸ªè¯è·å¾—çš„<span class="highlight">æ³¨æ„åŠ›æƒé‡ï¼ˆæ¦‚ç‡ï¼‰</span>ï¼š
            </p>
            
            <div class="probability-bars">
                <div class="bar-title">è¯"æˆ‘"å¯¹å…¶ä»–è¯çš„æ³¨æ„åŠ›åˆ†é…</div>
                
                <div class="bar-row">
                    <div class="bar-label">æˆ‘</div>
                    <div class="bar-container">
                        <div class="bar-fill" style="width: 99.2%;">99.2%</div>
                    </div>
                    <div class="bar-value">0.992</div>
                </div>
                
                <div class="bar-row">
                    <div class="bar-label">çˆ±</div>
                    <div class="bar-container">
                        <div class="bar-fill" style="width: 5%; animation-delay: 0.2s;">0.5%</div>
                    </div>
                    <div class="bar-value">0.005</div>
                </div>
                
                <div class="bar-row">
                    <div class="bar-label">å­¦ä¹ </div>
                    <div class="bar-container">
                        <div class="bar-fill" style="width: 1%; animation-delay: 0.4s;">0.1%</div>
                    </div>
                    <div class="bar-value">0.001</div>
                </div>
                
                <div class="bar-row">
                    <div class="bar-label">AI</div>
                    <div class="bar-container">
                        <div class="bar-fill" style="width: 2%; animation-delay: 0.6s;">0.2%</div>
                    </div>
                    <div class="bar-value">0.002</div>
                </div>
            </div>
            
            <p class="content-text" style="text-align: center; color: #00838f; font-weight: bold; margin-top: 20px;">
                "æˆ‘"è¿™ä¸ªè¯99.2%çš„æ³¨æ„åŠ›é›†ä¸­åœ¨è‡ªå·±èº«ä¸Š
            </p>
        </div>
        
        <!-- 5. Softmaxç‰¹æ€§ -->
        <div class="section">
            <h2 class="section-title">äº”ã€Softmaxçš„é‡è¦ç‰¹æ€§</h2>
            
            <div class="properties-grid">
                <div class="property-card">
                    <div class="property-icon">ğŸ“</div>
                    <div class="property-title">å½’ä¸€åŒ–</div>
                    <div class="property-desc">
                        è¾“å‡ºå€¼èŒƒå›´[0,1]<br>
                        æ‰€æœ‰è¾“å‡ºæ€»å’Œ=1<br>
                        å½¢æˆæ¦‚ç‡åˆ†å¸ƒ
                    </div>
                </div>
                
                <div class="property-card">
                    <div class="property-icon">ğŸ”º</div>
                    <div class="property-title">æ”¾å¤§å·®å¼‚</div>
                    <div class="property-desc">
                        é€šè¿‡expå‡½æ•°<br>
                        å¤§å€¼å˜æ›´å¤§<br>
                        å°å€¼å˜æ›´å°
                    </div>
                </div>
                
                <div class="property-card">
                    <div class="property-icon">ğŸ¯</div>
                    <div class="property-title">å¯å¾®åˆ†</div>
                    <div class="property-desc">
                        å¯¼æ•°è®¡ç®—ç®€å•<br>
                        åˆ©äºæ¢¯åº¦åä¼ <br>
                        è®­ç»ƒç¨³å®š
                    </div>
                </div>
                
                <div class="property-card">
                    <div class="property-icon">ğŸ”„</div>
                    <div class="property-title">å•è°ƒæ€§</div>
                    <div class="property-desc">
                        ä¿æŒç›¸å¯¹é¡ºåº<br>
                        æœ€å¤§å€¼ä»æœ€å¤§<br>
                        æœ€å°å€¼ä»æœ€å°
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 6. æ¸©åº¦å‚æ•° -->
        <div class="section">
            <h2 class="section-title">å…­ã€æ¸©åº¦å‚æ•°è°ƒèŠ‚</h2>
            <p class="content-text">
                Softmaxå¯ä»¥å¼•å…¥<span class="highlight">æ¸©åº¦å‚æ•°T</span>æ¥æ§åˆ¶åˆ†å¸ƒçš„"é™¡å³­ç¨‹åº¦"ï¼š
            </p>
            
            <div class="formula-box">
                <div class="formula">Softmax(x_i, T) = exp(x_i/T) / Î£ exp(x_j/T)</div>
            </div>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>æ¸©åº¦T</th>
                        <th>æ•ˆæœ</th>
                        <th>åˆ†å¸ƒç‰¹ç‚¹</th>
                        <th>åº”ç”¨åœºæ™¯</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>T â†’ 0</strong></td>
                        <td>åˆ†å¸ƒæ›´é™¡å³­</td>
                        <td>æ¥è¿‘one-hot<br>[0.99, 0.01, 0, 0]</td>
                        <td>éœ€è¦æ˜ç¡®å†³ç­–</td>
                    </tr>
                    <tr>
                        <td><strong>T = 1</strong></td>
                        <td>æ ‡å‡†Softmax</td>
                        <td>æ­£å¸¸åˆ†å¸ƒ<br>[0.7, 0.2, 0.08, 0.02]</td>
                        <td>å¸¸è§„ä½¿ç”¨</td>
                    </tr>
                    <tr>
                        <td><strong>T â†’ âˆ</strong></td>
                        <td>åˆ†å¸ƒæ›´å¹³ç¼“</td>
                        <td>æ¥è¿‘å‡åŒ€<br>[0.25, 0.25, 0.25, 0.25]</td>
                        <td>éœ€è¦å¤šæ ·æ€§</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- 7. æ©ç æœºåˆ¶ -->
        <div class="section">
            <h2 class="section-title">ä¸ƒã€æ©ç ï¼ˆMaskï¼‰å¤„ç†</h2>
            <p class="content-text">
                åœ¨è®¡ç®—Softmaxå‰ï¼Œå¸¸éœ€è¦<span class="highlight">å±è”½æŸäº›ä½ç½®</span>ï¼ˆå¦‚paddingã€æœªæ¥è¯ï¼‰ï¼š
            </p>
            
            <div class="tip-box">
                <div class="tip-title">ğŸ“Œ æ©ç æ–¹æ³•</div>
                <div class="tip-content">
                    <strong>å®ç°ï¼š</strong>åœ¨Softmaxå‰ï¼Œå°†éœ€è¦å±è”½çš„ä½ç½®è®¾ä¸º<span class="highlight">-âˆ</span><br>
                    <br>
                    <strong>æ•ˆæœï¼š</strong>exp(-âˆ) = 0ï¼ŒSoftmaxåè¯¥ä½ç½®æƒé‡ä¸º0<br>
                    <br>
                    <strong>åº”ç”¨ï¼š</strong><br>
                    â€¢ Paddingæ©ç ï¼šå¿½ç•¥å¡«å……çš„æ— æ•ˆè¯<br>
                    â€¢ å› æœæ©ç ï¼šDecoderä¸­é˜²æ­¢çœ‹åˆ°æœªæ¥è¯
                </div>
            </div>
            
            <div class="calculation-demo">
                <div class="calc-header">æ©ç ç¤ºä¾‹</div>
                <div class="calc-step">
                    <div class="step-title">åŸå§‹åˆ†æ•°</div>
                    <div class="step-detail">[2.5, 1.8, 3.2, 0.9]</div>
                </div>
                <div class="calc-step">
                    <div class="step-title">åº”ç”¨æ©ç ï¼ˆå±è”½åä¸¤ä¸ªï¼‰</div>
                    <div class="step-detail">[2.5, 1.8, -âˆ, -âˆ]</div>
                </div>
                <div class="calc-step">
                    <div class="step-title">Softmaxç»“æœ</div>
                    <div class="step-detail">[0.67, 0.33, 0.00, 0.00]</div>
                </div>
            </div>
        </div>
        
        <!-- 8. ä»£ç å®ç° -->
        <div class="section">
            <h2 class="section-title">å…«ã€PyTorchä»£ç å®ç°</h2>
            
            <div class="code-block">
<span style="color: #82b1ff;">import</span> torch
<span style="color: #82b1ff;">import</span> torch.nn.functional <span style="color: #82b1ff;">as</span> F

<span style="color: #82b1ff;">def</span> <span style="color: #ffb74d;">compute_attention_weights</span>(scores, mask=<span style="color: #82b1ff;">None</span>):
    <span style="color: #90a4ae;">"""
    è®¡ç®—æ³¨æ„åŠ›æƒé‡
    Args:
        scores: æ³¨æ„åŠ›åˆ†æ•°, shape (batch, seq_len, seq_len)
        mask: æ©ç , shape (batch, 1, seq_len) æˆ– (batch, seq_len, seq_len)
    Returns:
        weights: æ³¨æ„åŠ›æƒé‡ï¼ˆæ¦‚ç‡ï¼‰, shape (batch, seq_len, seq_len)
    """</span>
    
    <span style="color: #90a4ae;"># å¦‚æœæœ‰æ©ç ï¼Œå°†éœ€è¦å±è”½çš„ä½ç½®è®¾ä¸º-inf</span>
    <span style="color: #82b1ff;">if</span> mask <span style="color: #82b1ff;">is not None</span>:
        scores = scores.masked_fill(mask == 0, float(<span style="color: #aed581;">'-inf'</span>))
    
    <span style="color: #90a4ae;"># åº”ç”¨Softmaxï¼ˆåœ¨æœ€åä¸€ä¸ªç»´åº¦ä¸Šï¼‰</span>
    weights = F.softmax(scores, dim=-1)
    
    <span style="color: #82b1ff;">return</span> weights

<span style="color: #90a4ae;"># ä½¿ç”¨ç¤ºä¾‹</span>
batch_size = 2
seq_len = 4

<span style="color: #90a4ae;"># æ³¨æ„åŠ›åˆ†æ•°</span>
scores = torch.randn(batch_size, seq_len, seq_len)

<span style="color: #90a4ae;"># è®¡ç®—æ³¨æ„åŠ›æƒé‡</span>
weights = compute_attention_weights(scores)

<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"Scores shape: {scores.shape}"</span>)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"Weights shape: {weights.shape}"</span>)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"æƒé‡èŒƒå›´: [{weights.min():.3f}, {weights.max():.3f}]"</span>)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"æ¯è¡Œæ€»å’Œ: {weights.sum(dim=-1)}"</span>)

<span style="color: #90a4ae;"># å¸¦æ©ç çš„ç¤ºä¾‹</span>
mask = torch.ones(batch_size, 1, seq_len)
mask[:, :, 2:] = 0  <span style="color: #90a4ae;"># å±è”½åä¸¤ä¸ªä½ç½®</span>

weights_masked = compute_attention_weights(scores, mask)
<span style="color: #82b1ff;">print</span>(<span style="color: #aed581;">f"\nå¸¦æ©ç çš„æƒé‡:\n{weights_masked[0]}"</span>)
            </div>
        </div>
        
        <!-- æ€»ç»“ -->
        <div style="background: linear-gradient(135deg, #e0f7fa, #b2ebf2); padding: 30px; border-radius: 15px; margin-top: 40px;">
            <h3 style="color: #00838f; text-align: center; margin-bottom: 20px; font-size: 1.5em;">
                âœ¨ æ ¸å¿ƒè¦ç‚¹æ€»ç»“
            </h3>
            <div style="color: #555; line-height: 2; font-size: 1.05em;">
                âœ“ Softmaxå°†æ³¨æ„åŠ›åˆ†æ•°è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œæ€»å’Œä¸º1<br>
                âœ“ é€šè¿‡expå‡½æ•°æ”¾å¤§å·®å¼‚ï¼Œçªå‡ºé‡è¦ä¿¡æ¯<br>
                âœ“ è¾“å‡ºå¯è§£é‡Šä¸º"å¯¹æ¯ä¸ªè¯çš„æ³¨æ„åŠ›æƒé‡"<br>
                âœ“ æ”¯æŒæ©ç æœºåˆ¶ï¼Œå±è”½æ— æ•ˆæˆ–æœªæ¥ä½ç½®<br>
                âœ“ æ¸©åº¦å‚æ•°å¯è°ƒèŠ‚åˆ†å¸ƒçš„é™¡å³­ç¨‹åº¦
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; color: #999; font-size: 0.9em;">
            <p>Â© 2025 Softmaxå½’ä¸€åŒ–è¯¦è§£ - Transformerç³»åˆ—æ•™ç¨‹</p>
        </div>
    </div>
</body>
</html>